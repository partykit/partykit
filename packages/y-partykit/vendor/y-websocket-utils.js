var Is=Object.defineProperty;var jh=Object.getOwnPropertyDescriptor;var Ph=Object.getOwnPropertyNames;var zh=Object.prototype.hasOwnProperty;var k=(e,t)=>()=>(e&&(t=e(e=0)),t);var E=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),uo=(e,t)=>{for(var n in t)Is(e,n,{get:t[n],enumerable:!0})},Gh=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of Ph(t))!zh.call(e,s)&&s!==n&&Is(e,s,{get:()=>t[s],enumerable:!(r=jh(t,s))||r.enumerable});return e};var Kn=e=>Gh(Is({},"__esModule",{value:!0}),e);var H,nn,yt,fo,go,_e=k(()=>{H=()=>new Map,nn=e=>{let t=H();return e.forEach((n,r)=>{t.set(r,n)}),t},yt=(e,t,n)=>{let r=e.get(t);return r===void 0&&e.set(t,r=n()),r},fo=(e,t)=>{let n=[];for(let[r,s]of e)n.push(t(s,r));return n},go=(e,t)=>{for(let[n,r]of e)if(t(r,n))return!0;return!1}});var ce,Ss=k(()=>{ce=()=>new Set});var Wn,mo,Xn,Ts,bs=k(()=>{Wn=e=>e[e.length-1],mo=(e,t)=>{for(let n=0;n<t.length;n++)e.push(t[n])},Xn=Array.from,Ts=Array.isArray});var xe,yo=k(()=>{_e();Ss();bs();xe=class{constructor(){this._observers=H()}on(t,n){yt(this._observers,t,ce).add(n)}once(t,n){let r=(...s)=>{this.off(t,r),n(...s)};this.on(t,r)}off(t,n){let r=this._observers.get(t);r!==void 0&&(r.delete(n),r.size===0&&this._observers.delete(t))}emit(t,n){return Xn((this._observers.get(t)||H()).values()).forEach(r=>r(...n))}destroy(){this._observers=H()}}});var tt,ke,Zn,vt,pp,Yn,sn=k(()=>{tt=Math.floor,ke=Math.abs,Zn=(e,t)=>e<t?e:t,vt=(e,t)=>e>t?e:t,pp=Number.isNaN,Yn=e=>e!==0?e<0:1/e<0});var mp,wp,$h,Jh,Hh,Kh,Bs,Wh,Ee,Xh,Io,Ae,tr=k(()=>{mp=String.fromCharCode,wp=String.fromCodePoint,$h=e=>e.toLowerCase(),Jh=/^\s*/g,Hh=e=>e.replace(Jh,""),Kh=/([A-Z])/g,Bs=(e,t)=>Hh(e.replace(Kh,n=>`${t}${$h(n)}`)),Wh=e=>{let t=unescape(encodeURIComponent(e)),n=t.length,r=new Uint8Array(n);for(let s=0;s<n;s++)r[s]=t.codePointAt(s);return r},Ee=typeof TextEncoder<"u"?new TextEncoder:null,Xh=e=>Ee.encode(e),Io=Ee?Xh:Wh,Ae=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});Ae&&Ae.decode(new Uint8Array).length===1&&(Ae=null)});var _s,So=k(()=>{_s=e=>e===void 0?null:e});var xs,To,Yh,bo,Bo=k(()=>{xs=class{constructor(){this.map=new Map}setItem(t,n){this.map.set(t,n)}getItem(t){return this.map.get(t)}},To=new xs,Yh=!0;try{typeof localStorage<"u"&&(To=localStorage,Yh=!1)}catch{}bo=To});var tu,Uo,eu,nu,_o,xo=k(()=>{tu=Object.keys,Uo=e=>tu(e).length,eu=(e,t)=>{for(let n in e)if(!t(e[n],n))return!1;return!0},nu=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),_o=(e,t)=>e===t||Uo(e)===Uo(t)&&eu(e,(n,r)=>(n!==void 0||nu(t,r))&&t[r]===n)});var on,ko,er=k(()=>{on=(e,t,n=0)=>{try{for(;n<e.length;n++)e[n](...t)}finally{n<e.length&&on(e,t,n+1)}},ko=(e,t)=>t.includes(e)});var le,yp,It,su,iu,ks,nr,ou,Ip,Eo,Co,Do=k(()=>{_e();tr();So();Bo();er();le=typeof process<"u"&&process.release&&/node|io\.js/.test(process.release.name),yp=typeof navigator<"u"?/Mac/.test(navigator.platform):!1,su=[],iu=()=>{if(It===void 0)if(le){It=H();let e=process.argv,t=null;for(let n=0;n<e.length;n++){let r=e[n];r[0]==="-"?(t!==null&&It.set(t,""),t=r):t!==null?(It.set(t,r),t=null):su.push(r)}t!==null&&It.set(t,"")}else typeof location=="object"?(It=H(),(location.search||"?").slice(1).split("&").forEach(e=>{if(e.length!==0){let[t,n]=e.split("=");It.set(`--${Bs(t,"-")}`,n),It.set(`-${Bs(t,"-")}`,n)}})):It=H();return It},ks=e=>iu().has(e),nr=e=>le?_s(process.env[e.toUpperCase()]):_s(bo.getItem(e)),ou=e=>ks("--"+e)||nr(e)!==null,Ip=ou("production"),Eo=le&&ko(process.env.FORCE_COLOR,["true","1","2"]),Co=!ks("no-colors")&&(!le||process.stdout.isTTY||Eo)&&(!le||ks("color")||Eo||nr("COLORTERM")!==null||(nr("TERM")||"").includes("color"))});var As,Sp,Tp,vo,bp,Bp,Es=k(()=>{sn();As=Number.MAX_SAFE_INTEGER,Sp=Number.MIN_SAFE_INTEGER,Tp=1<<31,vo=Number.isInteger||(e=>typeof e=="number"&&isFinite(e)&&tt(e)===e),bp=Number.isNaN,Bp=Number.parseInt});var Pt,ut,X,Cs=k(()=>{Pt=e=>new Error(e),ut=()=>{throw Pt("Method unimplemented")},X=()=>{throw Pt("Unexpected case")}});var Lo,Mo,Ce,z,Ds,lu,K,ae,T,ln,au,hu,zt,vs,uu,du,fu,gu,De,cn,he,ve,rr,Ro=k(()=>{sr();sn();Es();tr();Cs();Lo=Pt("Unexpected end of array"),Mo=Pt("Integer out of Range"),Ce=class{constructor(t){this.arr=t,this.pos=0}},z=e=>new Ce(e),Ds=e=>e.pos!==e.arr.length,lu=(e,t)=>{let n=an(e.arr.buffer,e.pos+e.arr.byteOffset,t);return e.pos+=t,n},K=e=>lu(e,T(e)),ae=e=>e.arr[e.pos++],T=e=>{let t=0,n=1,r=e.arr.length;for(;e.pos<r;){let s=e.arr[e.pos++];if(t=t+(s&127)*n,n*=128,s<128)return t;if(t>As)throw Mo}throw Lo},ln=e=>{let t=e.arr[e.pos++],n=t&63,r=64,s=(t&64)>0?-1:1;if(!(t&128))return s*n;let i=e.arr.length;for(;e.pos<i;){if(t=e.arr[e.pos++],n=n+(t&127)*r,r*=128,t<128)return s*n;if(n>As)throw Mo}throw Lo},au=e=>{let t=T(e);if(t===0)return"";{let n=String.fromCodePoint(ae(e));if(--t<100)for(;t--;)n+=String.fromCodePoint(ae(e));else for(;t>0;){let r=t<1e4?t:1e4,s=e.arr.subarray(e.pos,e.pos+r);e.pos+=r,n+=String.fromCodePoint.apply(null,s),t-=r}return decodeURIComponent(escape(n))}},hu=e=>Ae.decode(K(e)),zt=Ae?hu:au,vs=(e,t)=>{let n=new DataView(e.arr.buffer,e.arr.byteOffset+e.pos,t);return e.pos+=t,n},uu=e=>vs(e,4).getFloat32(0,!1),du=e=>vs(e,8).getFloat64(0,!1),fu=e=>vs(e,8).getBigInt64(0,!1),gu=[e=>{},e=>null,ln,uu,du,fu,e=>!1,e=>!0,zt,e=>{let t=T(e),n={};for(let r=0;r<t;r++){let s=zt(e);n[s]=De(e)}return n},e=>{let t=T(e),n=[];for(let r=0;r<t;r++)n.push(De(e));return n},K],De=e=>gu[127-ae(e)](e),cn=class extends Ce{constructor(t,n){super(t),this.reader=n,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),Ds(this)?this.count=T(this)+1:this.count=-1),this.count--,this.s}},he=class extends Ce{constructor(t){super(t),this.s=0,this.count=0}read(){if(this.count===0){this.s=ln(this);let t=Yn(this.s);this.count=1,t&&(this.s=-this.s,this.count=T(this)+2)}return this.count--,this.s}},ve=class extends Ce{constructor(t){super(t),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){let t=ln(this),n=t&1;this.diff=tt(t/2),this.count=1,n&&(this.count=T(this)+2)}return this.s+=this.diff,this.count--,this.s}},rr=class{constructor(t){this.decoder=new he(t),this.str=zt(this.decoder),this.spos=0}read(){let t=this.spos+this.decoder.read(),n=this.str.slice(this.spos,t);return this.spos=t,n}}});var mu,an,Fo,sr=k(()=>{mu=e=>new Uint8Array(e),an=(e,t,n)=>new Uint8Array(e,t,n),Fo=e=>{let t=mu(e.byteLength);return t.set(e),t}});var ue,fe,wu,Z,yu,q,Le,w,un,Os,Iu,Su,Tu,$t,zo,Me,W,Ns,bu,Bu,Uu,qo,_u,Oe,hn,jo,de,Po,Ne,ir,Go=k(()=>{sr();sn();Es();tr();ue=class{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}},fe=()=>new ue,wu=e=>{let t=e.cpos;for(let n=0;n<e.bufs.length;n++)t+=e.bufs[n].length;return t},Z=e=>{let t=new Uint8Array(wu(e)),n=0;for(let r=0;r<e.bufs.length;r++){let s=e.bufs[r];t.set(s,n),n+=s.length}return t.set(an(e.cbuf.buffer,0,e.cpos),n),t},yu=(e,t)=>{let n=e.cbuf.length;n-e.cpos<t&&(e.bufs.push(an(e.cbuf.buffer,0,e.cpos)),e.cbuf=new Uint8Array(vt(n,t)*2),e.cpos=0)},q=(e,t)=>{let n=e.cbuf.length;e.cpos===n&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(n*2),e.cpos=0),e.cbuf[e.cpos++]=t},Le=q,w=(e,t)=>{for(;t>127;)q(e,128|127&t),t=tt(t/128);q(e,127&t)},un=(e,t)=>{let n=Yn(t);for(n&&(t=-t),q(e,(t>63?128:0)|(n?64:0)|63&t),t=tt(t/64);t>0;)q(e,(t>127?128:0)|127&t),t=tt(t/128)},Os=new Uint8Array(3e4),Iu=Os.length/3,Su=(e,t)=>{if(t.length<Iu){let n=Ee.encodeInto(t,Os).written||0;w(e,n);for(let r=0;r<n;r++)q(e,Os[r])}else W(e,Io(t))},Tu=(e,t)=>{let n=unescape(encodeURIComponent(t)),r=n.length;w(e,r);for(let s=0;s<r;s++)q(e,n.codePointAt(s))},$t=Ee&&Ee.encodeInto?Su:Tu,zo=(e,t)=>Me(e,Z(t)),Me=(e,t)=>{let n=e.cbuf.length,r=e.cpos,s=Zn(n-r,t.length),i=t.length-s;e.cbuf.set(t.subarray(0,s),r),e.cpos+=s,i>0&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(vt(n*2,i)),e.cbuf.set(t.subarray(s)),e.cpos=i)},W=(e,t)=>{w(e,t.byteLength),Me(e,t)},Ns=(e,t)=>{yu(e,t);let n=new DataView(e.cbuf.buffer,e.cpos,t);return e.cpos+=t,n},bu=(e,t)=>Ns(e,4).setFloat32(0,t,!1),Bu=(e,t)=>Ns(e,8).setFloat64(0,t,!1),Uu=(e,t)=>Ns(e,8).setBigInt64(0,t,!1),qo=new DataView(new ArrayBuffer(4)),_u=e=>(qo.setFloat32(0,e),qo.getFloat32(0)===e),Oe=(e,t)=>{switch(typeof t){case"string":q(e,119),$t(e,t);break;case"number":vo(t)&&ke(t)<=2147483647?(q(e,125),un(e,t)):_u(t)?(q(e,124),bu(e,t)):(q(e,123),Bu(e,t));break;case"bigint":q(e,122),Uu(e,t);break;case"object":if(t===null)q(e,126);else if(t instanceof Array){q(e,117),w(e,t.length);for(let n=0;n<t.length;n++)Oe(e,t[n])}else if(t instanceof Uint8Array)q(e,116),W(e,t);else{q(e,118);let n=Object.keys(t);w(e,n.length);for(let r=0;r<n.length;r++){let s=n[r];$t(e,s),Oe(e,t[s])}}break;case"boolean":q(e,t?120:121);break;default:q(e,127)}},hn=class extends ue{constructor(t){super(),this.w=t,this.s=null,this.count=0}write(t){this.s===t?this.count++:(this.count>0&&w(this,this.count-1),this.count=1,this.w(this,t),this.s=t)}},jo=e=>{e.count>0&&(un(e.encoder,e.count===1?e.s:-e.s),e.count>1&&w(e.encoder,e.count-2))},de=class{constructor(){this.encoder=new ue,this.s=0,this.count=0}write(t){this.s===t?this.count++:(jo(this),this.count=1,this.s=t)}toUint8Array(){return jo(this),Z(this.encoder)}},Po=e=>{if(e.count>0){let t=e.diff*2+(e.count===1?0:1);un(e.encoder,t),e.count>1&&w(e.encoder,e.count-2)}},Ne=class{constructor(){this.encoder=new ue,this.s=0,this.count=0,this.diff=0}write(t){this.diff===t-this.s?(this.s=t,this.count++):(Po(this),this.count=1,this.diff=t-this.s,this.s=t)}toUint8Array(){return Po(this),Z(this.encoder)}},ir=class{constructor(){this.sarr=[],this.s="",this.lensE=new de}write(t){this.s+=t,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(t.length)}toUint8Array(){let t=new ue;return this.sarr.push(this.s),this.s="",$t(t,this.sarr.join("")),Me(t,this.lensE.toUint8Array()),Z(t)}}});var ku,$o,Ls,Jo=k(()=>{ku=typeof window>"u"?null:typeof window.performance<"u"&&window.performance||null,$o=typeof crypto>"u"?null:crypto,Ls=$o!==null?e=>{let t=new ArrayBuffer(e),n=new Uint8Array(t);return $o.getRandomValues(n),t}:e=>{let t=new ArrayBuffer(e),n=new Uint8Array(t);for(let r=0;r<e;r++)n[r]=Math.ceil(Math.random()*4294967295>>>0);return t}});var Ho=k(()=>{Jo()});var Ms,Au,Ko,Wo=k(()=>{Ho();Ms=()=>new Uint32Array(Ls(4))[0],Au=[1e7]+-1e3+-4e3+-8e3+-1e11,Ko=()=>Au.replace(/[018]/g,e=>(e^Ms()&15>>e/4).toString(16))});var or,Rs=k(()=>{or=Date.now});var Zo,Yo=k(()=>{Zo=e=>new Promise(e)});var St,Qo=k(()=>{St=Symbol});var Fs,Tt,tc=k(()=>{Fs=class{constructor(t,n){this.left=t,this.right=n}},Tt=(e,t)=>new Fs(e,t)});var ge,Ep,ec,Cp,Dp,vp,Vp,Op,Np,Lp,nc=k(()=>{_e();ge=typeof document<"u"?document:{},Ep=typeof DOMParser<"u"?new DOMParser:null,ec=e=>fo(e,(t,n)=>`${n}:${t};`).join(""),Cp=ge.ELEMENT_NODE,Dp=ge.TEXT_NODE,vp=ge.CDATA_SECTION_NODE,Vp=ge.COMMENT_NODE,Op=ge.DOCUMENT_NODE,Np=ge.DOCUMENT_TYPE_NODE,Lp=ge.DOCUMENT_FRAGMENT_NODE});var cr,lr,rc,sc,ic,ar,oc,hr,cc,Ou,lc,Nu,Lu,Mu,Ru,ur,Fu,Pp,ac=k(()=>{Do();Qo();tc();nc();_e();Rs();cr=St(),lr=St(),rc=St(),sc=St(),ic=St(),ar=St(),oc=St(),hr=St(),cc=St(),Ou={[cr]:Tt("font-weight","bold"),[lr]:Tt("font-weight","normal"),[rc]:Tt("color","blue"),[ic]:Tt("color","green"),[sc]:Tt("color","grey"),[ar]:Tt("color","red"),[oc]:Tt("color","purple"),[hr]:Tt("color","orange"),[cc]:Tt("color","black")},lc={[cr]:"\x1B[1m",[lr]:"\x1B[2m",[rc]:"\x1B[34m",[ic]:"\x1B[32m",[sc]:"\x1B[37m",[ar]:"\x1B[31m",[oc]:"\x1B[35m",[hr]:"\x1B[38;5;208m",[cc]:"\x1B[0m"},Nu=e=>{let t=[],n=[],r=H(),s=[],i=0;for(;i<e.length;i++){let o=e[i],c=Ou[o];if(c!==void 0)r.set(c.left,c.right);else if(o.constructor===String||o.constructor===Number){let l=ec(r);i>0||l.length>0?(t.push("%c"+o),n.push(l)):t.push(o)}else break}for(i>0&&(s=n,s.unshift(t.join("")));i<e.length;i++){let o=e[i];o instanceof Symbol||s.push(o)}return s},Lu=e=>{let t=[],n=[],r=0;for(;r<e.length;r++){let s=e[r];if(lc[s]===void 0)if(s.constructor===String||s.constructor===Number)t.push(s);else break}for(r>0&&n.push(t.join(""));r<e.length;r++){let s=e[r];s instanceof Symbol||(s.constructor===Object?n.push(JSON.stringify(s)):n.push(s))}return n},Mu=e=>{let t=[],n=[],r=0;for(;r<e.length;r++){let s=e[r],i=lc[s];if(i!==void 0)t.push(i);else if(s.constructor===String||s.constructor===Number)t.push(s);else break}for(r>0&&(t.push("\x1B[0m"),n.push(t.join("")));r<e.length;r++){let s=e[r];s instanceof Symbol||n.push(s)}return n},Ru=Co?le?Mu:Nu:Lu,ur=(...e)=>{console.log(...Ru(e)),Fu.forEach(t=>t.print(e))},Fu=new Set,Pp=or()});var hc,uc,dr,dc=k(()=>{hc=e=>({[Symbol.iterator](){return this},next:e}),uc=(e,t)=>hc(()=>{let n;do n=e.next();while(!n.done&&!t(n.value));return n}),dr=(e,t)=>hc(()=>{let{done:n,value:r}=e.next();return{done:n,value:n?void 0:t(r)}})});var Vr={};uo(Vr,{AbsolutePosition:()=>Ir,AbstractConnector:()=>js,AbstractStruct:()=>qe,AbstractType:()=>L,Array:()=>dt,ContentAny:()=>xt,ContentBinary:()=>Qt,ContentDeleted:()=>te,ContentEmbed:()=>_t,ContentFormat:()=>O,ContentJSON:()=>be,ContentString:()=>Y,ContentType:()=>Q,Doc:()=>Ot,GC:()=>$,ID:()=>Vt,Item:()=>x,Map:()=>Bt,PermanentUserData:()=>zs,RelativePosition:()=>Fe,Snapshot:()=>yn,Text:()=>Mt,Transaction:()=>Tr,UndoManager:()=>Hs,UpdateEncoderV1:()=>Nt,XmlElement:()=>Yt,XmlFragment:()=>Ut,XmlHook:()=>Ie,XmlText:()=>Se,YArrayEvent:()=>Ur,YEvent:()=>ye,YMapEvent:()=>_r,YTextEvent:()=>xr,YXmlEvent:()=>kr,applyUpdate:()=>Xu,applyUpdateV2:()=>Cr,cleanupYTextFormatting:()=>al,compareIDs:()=>me,compareRelativePositions:()=>dd,convertUpdateFormatV1ToV2:()=>Ed,convertUpdateFormatV2ToV1:()=>Hc,createAbsolutePositionFromRelativePosition:()=>ud,createDeleteSet:()=>Er,createDeleteSetFromStructStore:()=>Ys,createDocFromSnapshot:()=>yd,createID:()=>y,createRelativePositionFromJSON:()=>sd,createRelativePositionFromTypeIndex:()=>od,createSnapshot:()=>si,decodeRelativePosition:()=>hd,decodeSnapshot:()=>pd,decodeSnapshotV2:()=>Oc,decodeStateVector:()=>ei,decodeUpdate:()=>Ud,decodeUpdateV2:()=>jc,diffUpdate:()=>Ad,diffUpdateV2:()=>ii,emptySnapshot:()=>md,encodeRelativePosition:()=>ld,encodeSnapshot:()=>gd,encodeSnapshotV2:()=>Vc,encodeStateAsUpdate:()=>Yu,encodeStateAsUpdateV2:()=>Cc,encodeStateVector:()=>ed,encodeStateVectorFromUpdate:()=>_d,encodeStateVectorFromUpdateV2:()=>zc,equalSnapshots:()=>fd,findIndexSS:()=>rt,findRootTypeKey:()=>ri,getItem:()=>dn,getState:()=>v,getTypeChildren:()=>Vd,isDeleted:()=>je,isParentOf:()=>wn,iterateDeletedStructs:()=>Wt,logType:()=>nd,logUpdate:()=>Bd,logUpdateV2:()=>qc,mergeUpdates:()=>Pc,mergeUpdatesV2:()=>Sn,parseUpdateMeta:()=>xd,parseUpdateMetaV2:()=>Gc,readUpdate:()=>Wu,readUpdateV2:()=>ti,relativePositionToJSON:()=>rd,snapshot:()=>wd,transact:()=>A,tryGc:()=>Td,typeListToArraySnapshot:()=>Od,typeMapGetSnapshot:()=>Md});function*bd(e){let t=T(e.restDecoder);for(let n=0;n<t;n++){let r=T(e.restDecoder),s=e.readClient(),i=T(e.restDecoder);for(let o=0;o<r;o++){let c=e.readInfo();if(c===10){let l=T(e.restDecoder);yield new J(y(s,i),l),i+=l}else if(31&c){let l=(c&192)===0,h=new x(y(s,i),null,(c&128)===128?e.readLeftID():null,null,(c&64)===64?e.readRightID():null,l?e.readParentInfo()?e.readString():e.readLeftID():null,l&&(c&32)===32?e.readString():null,dl(e,c));yield h,i+=h.length}else{let l=e.readLen();yield new $(y(s,i),l),i+=l}}}}var js,gn,Kt,Wt,Gu,je,Zs,pn,mn,Er,Ys,bt,Xt,pc,Ec,Ot,we,ft,yr,nt,Zt,Nt,Re,gt,$u,Qs,Ju,Hu,Ku,ti,Wu,Cr,Xu,Zu,Cc,Yu,Dc,ei,ni,Qu,td,ed,Ps,mc,wc,yc,vc,Vt,me,y,Ic,Sc,ri,wn,nd,zs,Fe,rd,sd,Ir,id,fr,od,cd,ld,ad,hd,ud,dd,yn,fd,Vc,gd,Oc,pd,si,md,wd,pe,Gs,yd,Sr,Un,v,Nc,rt,Id,dn,$s,G,Tc,Sd,Lc,Tr,bc,Bc,mr,Mc,Rc,Td,Fc,A,Js,Uc,_c,Hs,Lt,Bd,qc,Ud,jc,In,Pc,zc,_d,Gc,xd,kd,Sn,ii,Ad,$c,Jt,oi,Jc,Ed,Hc,ye,Cd,Kc,ci,Ks,Dd,Wc,vd,Dr,Tn,Vd,vr,L,Xc,Zc,Od,bn,Yc,Nd,Qc,br,tl,el,Ld,nl,Br,li,ai,rl,sl,Md,gr,Ur,dt,Rd,_r,Bt,Fd,Ht,Bn,xc,pr,il,Pe,ol,cl,qs,kc,ll,qd,al,Ac,xr,Mt,jd,fn,Ut,Pd,Yt,zd,kr,Ie,Gd,Se,$d,qe,Jd,$,Qt,Hd,te,Kd,hl,Te,Wd,_t,Xd,O,Zd,be,Yd,xt,Qd,Y,tf,ef,nf,rf,sf,of,cf,lf,af,Q,hf,Ws,hi,Ar,ul,x,dl,uf,df,J,fl,gl,Or=k(()=>{yo();bs();sn();_e();Go();Ro();Wo();Yo();sr();Cs();er();er();Ss();ac();Rs();dc();xo();js=class extends xe{constructor(t,n){super(),this.doc=t,this.awareness=n}},gn=class{constructor(t,n){this.clock=t,this.len=n}},Kt=class{constructor(){this.clients=new Map}},Wt=(e,t,n)=>t.clients.forEach((r,s)=>{let i=e.doc.store.clients.get(s);for(let o=0;o<r.length;o++){let c=r[o];Lc(e,i,c.clock,c.len,n)}}),Gu=(e,t)=>{let n=0,r=e.length-1;for(;n<=r;){let s=tt((n+r)/2),i=e[s],o=i.clock;if(o<=t){if(t<o+i.len)return s;n=s+1}else r=s-1}return null},je=(e,t)=>{let n=e.clients.get(t.client);return n!==void 0&&Gu(n,t.clock)!==null},Zs=e=>{e.clients.forEach(t=>{t.sort((s,i)=>s.clock-i.clock);let n,r;for(n=1,r=1;n<t.length;n++){let s=t[r-1],i=t[n];s.clock+s.len>=i.clock?s.len=vt(s.len,i.clock+i.len-s.clock):(r<n&&(t[r]=i),r++)}t.length=r})},pn=e=>{let t=new Kt;for(let n=0;n<e.length;n++)e[n].clients.forEach((r,s)=>{if(!t.clients.has(s)){let i=r.slice();for(let o=n+1;o<e.length;o++)mo(i,e[o].clients.get(s)||[]);t.clients.set(s,i)}});return Zs(t),t},mn=(e,t,n,r)=>{yt(e.clients,t,()=>[]).push(new gn(n,r))},Er=()=>new Kt,Ys=e=>{let t=Er();return e.clients.forEach((n,r)=>{let s=[];for(let i=0;i<n.length;i++){let o=n[i];if(o.deleted){let c=o.id.clock,l=o.length;if(i+1<n.length)for(let h=n[i+1];i+1<n.length&&h.deleted;h=n[++i+1])l+=h.length;s.push(new gn(c,l))}}s.length>0&&t.clients.set(r,s)}),t},bt=(e,t)=>{w(e.restEncoder,t.clients.size),t.clients.forEach((n,r)=>{e.resetDsCurVal(),w(e.restEncoder,r);let s=n.length;w(e.restEncoder,s);for(let i=0;i<s;i++){let o=n[i];e.writeDsClock(o.clock),e.writeDsLen(o.len)}})},Xt=e=>{let t=new Kt,n=T(e.restDecoder);for(let r=0;r<n;r++){e.resetDsCurVal();let s=T(e.restDecoder),i=T(e.restDecoder);if(i>0){let o=yt(t.clients,s,()=>[]);for(let c=0;c<i;c++)o.push(new gn(e.readDsClock(),e.readDsLen()))}}return t},pc=(e,t,n)=>{let r=new Kt,s=T(e.restDecoder);for(let i=0;i<s;i++){e.resetDsCurVal();let o=T(e.restDecoder),c=T(e.restDecoder),l=n.clients.get(o)||[],h=v(n,o);for(let a=0;a<c;a++){let u=e.readDsClock(),f=u+e.readDsLen();if(u<h){h<f&&mn(r,o,h,f-h);let d=rt(l,u),g=l[d];for(!g.deleted&&g.id.clock<u&&(l.splice(d+1,0,Ar(t,g,u-g.id.clock)),d++);d<l.length&&(g=l[d++],g.id.clock<f);)g.deleted||(f<g.id.clock+g.length&&l.splice(d,0,Ar(t,g,f-g.id.clock)),g.delete(t))}else mn(r,o,u,f-u)}}if(r.clients.size>0){let i=new gt;return w(i.restEncoder,0),bt(i,r),i.toUint8Array()}return null},Ec=Ms,Ot=class extends xe{constructor({guid:t=Ko(),collectionid:n=null,gc:r=!0,gcFilter:s=()=>!0,meta:i=null,autoLoad:o=!1,shouldLoad:c=!0}={}){super(),this.gc=r,this.gcFilter=s,this.clientID=Ec(),this.guid=t,this.collectionid=n,this.share=new Map,this.store=new Sr,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=c,this.autoLoad=o,this.meta=i,this.isLoaded=!1,this.whenLoaded=Zo(l=>{this.on("load",()=>{this.isLoaded=!0,l(this)})})}load(){let t=this._item;t!==null&&!this.shouldLoad&&A(t.parent.doc,n=>{n.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(Array.from(this.subdocs).map(t=>t.guid))}transact(t,n=null){A(this,t,n)}get(t,n=L){let r=yt(this.share,t,()=>{let i=new n;return i._integrate(this,null),i}),s=r.constructor;if(n!==L&&s!==n)if(s===L){let i=new n;i._map=r._map,r._map.forEach(o=>{for(;o!==null;o=o.left)o.parent=i}),i._start=r._start;for(let o=i._start;o!==null;o=o.right)o.parent=i;return i._length=r._length,this.share.set(t,i),i._integrate(this,null),i}else throw new Error(`Type with the name ${t} has already been defined with a different constructor`);return r}getArray(t=""){return this.get(t,dt)}getText(t=""){return this.get(t,Mt)}getMap(t=""){return this.get(t,Bt)}getXmlFragment(t=""){return this.get(t,Ut)}toJSON(){let t={};return this.share.forEach((n,r)=>{t[r]=n.toJSON()}),t}destroy(){Xn(this.subdocs).forEach(n=>n.destroy());let t=this._item;if(t!==null){this._item=null;let n=t.content;n.doc=new Ot({guid:this.guid,...n.opts,shouldLoad:!1}),n.doc._item=t,A(t.parent.doc,r=>{let s=n.doc;t.deleted||r.subdocsAdded.add(s),r.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}on(t,n){super.on(t,n)}off(t,n){super.off(t,n)}},we=class{constructor(t){this.restDecoder=t}resetDsCurVal(){}readDsClock(){return T(this.restDecoder)}readDsLen(){return T(this.restDecoder)}},ft=class extends we{readLeftID(){return y(T(this.restDecoder),T(this.restDecoder))}readRightID(){return y(T(this.restDecoder),T(this.restDecoder))}readClient(){return T(this.restDecoder)}readInfo(){return ae(this.restDecoder)}readString(){return zt(this.restDecoder)}readParentInfo(){return T(this.restDecoder)===1}readTypeRef(){return T(this.restDecoder)}readLen(){return T(this.restDecoder)}readAny(){return De(this.restDecoder)}readBuf(){return Fo(K(this.restDecoder))}readJSON(){return JSON.parse(zt(this.restDecoder))}readKey(){return zt(this.restDecoder)}},yr=class{constructor(t){this.dsCurrVal=0,this.restDecoder=t}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=T(this.restDecoder),this.dsCurrVal}readDsLen(){let t=T(this.restDecoder)+1;return this.dsCurrVal+=t,t}},nt=class extends yr{constructor(t){super(t),this.keys=[],T(t),this.keyClockDecoder=new ve(K(t)),this.clientDecoder=new he(K(t)),this.leftClockDecoder=new ve(K(t)),this.rightClockDecoder=new ve(K(t)),this.infoDecoder=new cn(K(t),ae),this.stringDecoder=new rr(K(t)),this.parentInfoDecoder=new cn(K(t),ae),this.typeRefDecoder=new he(K(t)),this.lenDecoder=new he(K(t))}readLeftID(){return new Vt(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new Vt(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return De(this.restDecoder)}readBuf(){return K(this.restDecoder)}readJSON(){return De(this.restDecoder)}readKey(){let t=this.keyClockDecoder.read();if(t<this.keys.length)return this.keys[t];{let n=this.stringDecoder.read();return this.keys.push(n),n}}},Zt=class{constructor(){this.restEncoder=fe()}toUint8Array(){return Z(this.restEncoder)}resetDsCurVal(){}writeDsClock(t){w(this.restEncoder,t)}writeDsLen(t){w(this.restEncoder,t)}},Nt=class extends Zt{writeLeftID(t){w(this.restEncoder,t.client),w(this.restEncoder,t.clock)}writeRightID(t){w(this.restEncoder,t.client),w(this.restEncoder,t.clock)}writeClient(t){w(this.restEncoder,t)}writeInfo(t){Le(this.restEncoder,t)}writeString(t){$t(this.restEncoder,t)}writeParentInfo(t){w(this.restEncoder,t?1:0)}writeTypeRef(t){w(this.restEncoder,t)}writeLen(t){w(this.restEncoder,t)}writeAny(t){Oe(this.restEncoder,t)}writeBuf(t){W(this.restEncoder,t)}writeJSON(t){$t(this.restEncoder,JSON.stringify(t))}writeKey(t){$t(this.restEncoder,t)}},Re=class{constructor(){this.restEncoder=fe(),this.dsCurrVal=0}toUint8Array(){return Z(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(t){let n=t-this.dsCurrVal;this.dsCurrVal=t,w(this.restEncoder,n)}writeDsLen(t){t===0&&X(),w(this.restEncoder,t-1),this.dsCurrVal+=t}},gt=class extends Re{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new Ne,this.clientEncoder=new de,this.leftClockEncoder=new Ne,this.rightClockEncoder=new Ne,this.infoEncoder=new hn(Le),this.stringEncoder=new ir,this.parentInfoEncoder=new hn(Le),this.typeRefEncoder=new de,this.lenEncoder=new de}toUint8Array(){let t=fe();return w(t,0),W(t,this.keyClockEncoder.toUint8Array()),W(t,this.clientEncoder.toUint8Array()),W(t,this.leftClockEncoder.toUint8Array()),W(t,this.rightClockEncoder.toUint8Array()),W(t,Z(this.infoEncoder)),W(t,this.stringEncoder.toUint8Array()),W(t,Z(this.parentInfoEncoder)),W(t,this.typeRefEncoder.toUint8Array()),W(t,this.lenEncoder.toUint8Array()),Me(t,Z(this.restEncoder)),Z(t)}writeLeftID(t){this.clientEncoder.write(t.client),this.leftClockEncoder.write(t.clock)}writeRightID(t){this.clientEncoder.write(t.client),this.rightClockEncoder.write(t.clock)}writeClient(t){this.clientEncoder.write(t)}writeInfo(t){this.infoEncoder.write(t)}writeString(t){this.stringEncoder.write(t)}writeParentInfo(t){this.parentInfoEncoder.write(t?1:0)}writeTypeRef(t){this.typeRefEncoder.write(t)}writeLen(t){this.lenEncoder.write(t)}writeAny(t){Oe(this.restEncoder,t)}writeBuf(t){W(this.restEncoder,t)}writeJSON(t){Oe(this.restEncoder,t)}writeKey(t){let n=this.keyMap.get(t);n===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(t)):this.keyClockEncoder.write(n)}},$u=(e,t,n,r)=>{r=vt(r,t[0].id.clock);let s=rt(t,r);w(e.restEncoder,t.length-s),e.writeClient(n),w(e.restEncoder,r);let i=t[s];i.write(e,r-i.id.clock);for(let o=s+1;o<t.length;o++)t[o].write(e,0)},Qs=(e,t,n)=>{let r=new Map;n.forEach((s,i)=>{v(t,i)>s&&r.set(i,s)}),Un(t).forEach((s,i)=>{n.has(i)||r.set(i,0)}),w(e.restEncoder,r.size),Array.from(r.entries()).sort((s,i)=>i[0]-s[0]).forEach(([s,i])=>{$u(e,t.clients.get(s),s,i)})},Ju=(e,t)=>{let n=H(),r=T(e.restDecoder);for(let s=0;s<r;s++){let i=T(e.restDecoder),o=new Array(i),c=e.readClient(),l=T(e.restDecoder);n.set(c,{i:0,refs:o});for(let h=0;h<i;h++){let a=e.readInfo();switch(31&a){case 0:{let u=e.readLen();o[h]=new $(y(c,l),u),l+=u;break}case 10:{let u=T(e.restDecoder);o[h]=new J(y(c,l),u),l+=u;break}default:{let u=(a&192)===0,f=new x(y(c,l),null,(a&128)===128?e.readLeftID():null,null,(a&64)===64?e.readRightID():null,u?e.readParentInfo()?t.get(e.readString()):e.readLeftID():null,u&&(a&32)===32?e.readString():null,dl(e,a));o[h]=f,l+=f.length}}}}return n},Hu=(e,t,n)=>{let r=[],s=Array.from(n.keys()).sort((d,g)=>d-g);if(s.length===0)return null;let i=()=>{if(s.length===0)return null;let d=n.get(s[s.length-1]);for(;d.refs.length===d.i;)if(s.pop(),s.length>0)d=n.get(s[s.length-1]);else return null;return d},o=i();if(o===null&&r.length===0)return null;let c=new Sr,l=new Map,h=(d,g)=>{let I=l.get(d);(I==null||I>g)&&l.set(d,g)},a=o.refs[o.i++],u=new Map,f=()=>{for(let d of r){let g=d.id.client,I=n.get(g);I?(I.i--,c.clients.set(g,I.refs.slice(I.i)),n.delete(g),I.i=0,I.refs=[]):c.clients.set(g,[d]),s=s.filter(S=>S!==g)}r.length=0};for(;;){if(a.constructor!==J){let g=yt(u,a.id.client,()=>v(t,a.id.client))-a.id.clock;if(g<0)r.push(a),h(a.id.client,a.id.clock-1),f();else{let I=a.getMissing(e,t);if(I!==null){r.push(a);let S=n.get(I)||{refs:[],i:0};if(S.refs.length===S.i)h(I,v(t,I)),f();else{a=S.refs[S.i++];continue}}else(g===0||g<a.length)&&(a.integrate(e,g),u.set(a.id.client,a.id.clock+a.length))}}if(r.length>0)a=r.pop();else if(o!==null&&o.i<o.refs.length)a=o.refs[o.i++];else{if(o=i(),o===null)break;a=o.refs[o.i++]}}if(c.clients.size>0){let d=new gt;return Qs(d,c,new Map),w(d.restEncoder,0),{missing:l,update:d.toUint8Array()}}return null},Ku=(e,t)=>Qs(e,t.doc.store,t.beforeState),ti=(e,t,n,r=new nt(e))=>A(t,s=>{s.local=!1;let i=!1,o=s.doc,c=o.store,l=Ju(r,o),h=Hu(s,c,l),a=c.pendingStructs;if(a){for(let[f,d]of a.missing)if(d<v(c,f)){i=!0;break}if(h){for(let[f,d]of h.missing){let g=a.missing.get(f);(g==null||g>d)&&a.missing.set(f,d)}a.update=Sn([a.update,h.update])}}else c.pendingStructs=h;let u=pc(r,s,c);if(c.pendingDs){let f=new nt(z(c.pendingDs));T(f.restDecoder);let d=pc(f,s,c);u&&d?c.pendingDs=Sn([u,d]):c.pendingDs=u||d}else c.pendingDs=u;if(i){let f=c.pendingStructs.update;c.pendingStructs=null,Cr(s.doc,f)}},n,!1),Wu=(e,t,n)=>ti(e,t,n,new ft(e)),Cr=(e,t,n,r=nt)=>{let s=z(t);ti(s,e,n,new r(s))},Xu=(e,t,n)=>Cr(e,t,n,ft),Zu=(e,t,n=new Map)=>{Qs(e,t.store,n),bt(e,Ys(t.store))},Cc=(e,t=new Uint8Array([0]),n=new gt)=>{let r=ei(t);Zu(n,e,r);let s=[n.toUint8Array()];if(e.store.pendingDs&&s.push(e.store.pendingDs),e.store.pendingStructs&&s.push(ii(e.store.pendingStructs.update,t)),s.length>1){if(n.constructor===Nt)return Pc(s.map((i,o)=>o===0?i:Hc(i)));if(n.constructor===gt)return Sn(s)}return s[0]},Yu=(e,t)=>Cc(e,t,new Nt),Dc=e=>{let t=new Map,n=T(e.restDecoder);for(let r=0;r<n;r++){let s=T(e.restDecoder),i=T(e.restDecoder);t.set(s,i)}return t},ei=e=>Dc(new we(z(e))),ni=(e,t)=>(w(e.restEncoder,t.size),Array.from(t.entries()).sort((n,r)=>r[0]-n[0]).forEach(([n,r])=>{w(e.restEncoder,n),w(e.restEncoder,r)}),e),Qu=(e,t)=>ni(e,Un(t.store)),td=(e,t=new Re)=>(e instanceof Map?ni(t,e):Qu(t,e),t.toUint8Array()),ed=e=>td(e,new Zt),Ps=class{constructor(){this.l=[]}},mc=()=>new Ps,wc=(e,t)=>e.l.push(t),yc=(e,t)=>{let n=e.l,r=n.length;e.l=n.filter(s=>t!==s),r===e.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},vc=(e,t,n)=>on(e.l,[t,n]),Vt=class{constructor(t,n){this.client=t,this.clock=n}},me=(e,t)=>e===t||e!==null&&t!==null&&e.client===t.client&&e.clock===t.clock,y=(e,t)=>new Vt(e,t),Ic=(e,t)=>{w(e,t.client),w(e,t.clock)},Sc=e=>y(T(e),T(e)),ri=e=>{for(let[t,n]of e.doc.share.entries())if(n===e)return t;throw X()},wn=(e,t)=>{for(;t!==null;){if(t.parent===e)return!0;t=t.parent._item}return!1},nd=e=>{let t=[],n=e._start;for(;n;)t.push(n),n=n.right;console.log("Children: ",t),console.log("Children content: ",t.filter(r=>!r.deleted).map(r=>r.content))},zs=class{constructor(t,n=t.getMap("users")){let r=new Map;this.yusers=n,this.doc=t,this.clients=new Map,this.dss=r;let s=(i,o)=>{let c=i.get("ds"),l=i.get("ids"),h=a=>this.clients.set(a,o);c.observe(a=>{a.changes.added.forEach(u=>{u.content.getContent().forEach(f=>{f instanceof Uint8Array&&this.dss.set(o,pn([this.dss.get(o)||Er(),Xt(new we(z(f)))]))})})}),this.dss.set(o,pn(c.map(a=>Xt(new we(z(a)))))),l.observe(a=>a.changes.added.forEach(u=>u.content.getContent().forEach(h))),l.forEach(h)};n.observe(i=>{i.keysChanged.forEach(o=>s(n.get(o),o))}),n.forEach(s)}setUserMapping(t,n,r,{filter:s=()=>!0}={}){let i=this.yusers,o=i.get(r);o||(o=new Bt,o.set("ids",new dt),o.set("ds",new dt),i.set(r,o)),o.get("ids").push([n]),i.observe(c=>{setTimeout(()=>{let l=i.get(r);if(l!==o){o=l,this.clients.forEach((u,f)=>{r===u&&o.get("ids").push([f])});let h=new Zt,a=this.dss.get(r);a&&(bt(h,a),o.get("ds").push([h.toUint8Array()]))}},0)}),t.on("afterTransaction",c=>{setTimeout(()=>{let l=o.get("ds"),h=c.deleteSet;if(c.local&&h.clients.size>0&&s(c,h)){let a=new Zt;bt(a,h),l.push([a.toUint8Array()])}})})}getUserByClientId(t){return this.clients.get(t)||null}getUserByDeletedId(t){for(let[n,r]of this.dss.entries())if(je(r,t))return n;return null}},Fe=class{constructor(t,n,r,s=0){this.type=t,this.tname=n,this.item=r,this.assoc=s}},rd=e=>{let t={};return e.type&&(t.type=e.type),e.tname&&(t.tname=e.tname),e.item&&(t.item=e.item),e.assoc!=null&&(t.assoc=e.assoc),t},sd=e=>new Fe(e.type==null?null:y(e.type.client,e.type.clock),e.tname||null,e.item==null?null:y(e.item.client,e.item.clock),e.assoc==null?0:e.assoc),Ir=class{constructor(t,n,r=0){this.type=t,this.index=n,this.assoc=r}},id=(e,t,n=0)=>new Ir(e,t,n),fr=(e,t,n)=>{let r=null,s=null;return e._item===null?s=ri(e):r=y(e._item.id.client,e._item.id.clock),new Fe(r,s,t,n)},od=(e,t,n=0)=>{let r=e._start;if(n<0){if(t===0)return fr(e,null,n);t--}for(;r!==null;){if(!r.deleted&&r.countable){if(r.length>t)return fr(e,y(r.id.client,r.id.clock+t),n);t-=r.length}if(r.right===null&&n<0)return fr(e,r.lastId,n);r=r.right}return fr(e,null,n)},cd=(e,t)=>{let{type:n,tname:r,item:s,assoc:i}=t;if(s!==null)w(e,0),Ic(e,s);else if(r!==null)Le(e,1),$t(e,r);else if(n!==null)Le(e,2),Ic(e,n);else throw X();return un(e,i),e},ld=e=>{let t=fe();return cd(t,e),Z(t)},ad=e=>{let t=null,n=null,r=null;switch(T(e)){case 0:r=Sc(e);break;case 1:n=zt(e);break;case 2:t=Sc(e)}let s=Ds(e)?ln(e):0;return new Fe(t,n,r,s)},hd=e=>ad(z(e)),ud=(e,t)=>{let n=t.store,r=e.item,s=e.type,i=e.tname,o=e.assoc,c=null,l=0;if(r!==null){if(v(n,r.client)<=r.clock)return null;let h=Ws(n,r),a=h.item;if(!(a instanceof x))return null;if(c=a.parent,c._item===null||!c._item.deleted){l=a.deleted||!a.countable?0:h.diff+(o>=0?0:1);let u=a.left;for(;u!==null;)!u.deleted&&u.countable&&(l+=u.length),u=u.left}}else{if(i!==null)c=t.get(i);else if(s!==null){if(v(n,s.client)<=s.clock)return null;let{item:h}=Ws(n,s);if(h instanceof x&&h.content instanceof Q)c=h.content.type;else return null}else throw X();o>=0?l=c._length:l=0}return id(c,l,e.assoc)},dd=(e,t)=>e===t||e!==null&&t!==null&&e.tname===t.tname&&me(e.item,t.item)&&me(e.type,t.type)&&e.assoc===t.assoc,yn=class{constructor(t,n){this.ds=t,this.sv=n}},fd=(e,t)=>{let n=e.ds.clients,r=t.ds.clients,s=e.sv,i=t.sv;if(s.size!==i.size||n.size!==r.size)return!1;for(let[o,c]of s.entries())if(i.get(o)!==c)return!1;for(let[o,c]of n.entries()){let l=r.get(o)||[];if(c.length!==l.length)return!1;for(let h=0;h<c.length;h++){let a=c[h],u=l[h];if(a.clock!==u.clock||a.len!==u.len)return!1}}return!0},Vc=(e,t=new Re)=>(bt(t,e.ds),ni(t,e.sv),t.toUint8Array()),gd=e=>Vc(e,new Zt),Oc=(e,t=new yr(z(e)))=>new yn(Xt(t),Dc(t)),pd=e=>Oc(e,new we(z(e))),si=(e,t)=>new yn(e,t),md=si(Er(),new Map),wd=e=>si(Ys(e.store),Un(e.store)),pe=(e,t)=>t===void 0?!e.deleted:t.sv.has(e.id.client)&&(t.sv.get(e.id.client)||0)>e.id.clock&&!je(t.ds,e.id),Gs=(e,t)=>{let n=yt(e.meta,Gs,ce),r=e.doc.store;n.has(t)||(t.sv.forEach((s,i)=>{s<v(r,i)&&G(e,y(i,s))}),Wt(e,t.ds,s=>{}),n.add(t))},yd=(e,t,n=new Ot)=>{if(e.gc)throw new Error("originDoc must not be garbage collected");let{sv:r,ds:s}=t,i=new gt;return e.transact(o=>{let c=0;r.forEach(l=>{l>0&&c++}),w(i.restEncoder,c);for(let[l,h]of r){if(h===0)continue;h<v(e.store,l)&&G(o,y(l,h));let a=e.store.clients.get(l)||[],u=rt(a,h-1);w(i.restEncoder,u+1),i.writeClient(l),w(i.restEncoder,0);for(let f=0;f<=u;f++)a[f].write(i,0)}bt(i,s)}),Cr(n,i.toUint8Array(),"snapshot"),n},Sr=class{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}},Un=e=>{let t=new Map;return e.clients.forEach((n,r)=>{let s=n[n.length-1];t.set(r,s.id.clock+s.length)}),t},v=(e,t)=>{let n=e.clients.get(t);if(n===void 0)return 0;let r=n[n.length-1];return r.id.clock+r.length},Nc=(e,t)=>{let n=e.clients.get(t.id.client);if(n===void 0)n=[],e.clients.set(t.id.client,n);else{let r=n[n.length-1];if(r.id.clock+r.length!==t.id.clock)throw X()}n.push(t)},rt=(e,t)=>{let n=0,r=e.length-1,s=e[r],i=s.id.clock;if(i===t)return r;let o=tt(t/(i+s.length-1)*r);for(;n<=r;){if(s=e[o],i=s.id.clock,i<=t){if(t<i+s.length)return o;n=o+1}else r=o-1;o=tt((n+r)/2)}throw X()},Id=(e,t)=>{let n=e.clients.get(t.client);return n[rt(n,t.clock)]},dn=Id,$s=(e,t,n)=>{let r=rt(t,n),s=t[r];return s.id.clock<n&&s instanceof x?(t.splice(r+1,0,Ar(e,s,n-s.id.clock)),r+1):r},G=(e,t)=>{let n=e.doc.store.clients.get(t.client);return n[$s(e,n,t.clock)]},Tc=(e,t,n)=>{let r=t.clients.get(n.client),s=rt(r,n.clock),i=r[s];return n.clock!==i.id.clock+i.length-1&&i.constructor!==$&&r.splice(s+1,0,Ar(e,i,n.clock-i.id.clock+1)),i},Sd=(e,t,n)=>{let r=e.clients.get(t.id.client);r[rt(r,t.id.clock)]=n},Lc=(e,t,n,r,s)=>{if(r===0)return;let i=n+r,o=$s(e,t,n),c;do c=t[o++],i<c.id.clock+c.length&&$s(e,t,i),s(c);while(o<t.length&&t[o].id.clock<i)},Tr=class{constructor(t,n,r){this.doc=t,this.deleteSet=new Kt,this.beforeState=Un(t.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=n,this.meta=new Map,this.local=r,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set}},bc=(e,t)=>t.deleteSet.clients.size===0&&!go(t.afterState,(n,r)=>t.beforeState.get(r)!==n)?!1:(Zs(t.deleteSet),Ku(e,t),bt(e,t.deleteSet),!0),Bc=(e,t,n)=>{let r=t._item;(r===null||r.id.clock<(e.beforeState.get(r.id.client)||0)&&!r.deleted)&&yt(e.changed,t,ce).add(n)},mr=(e,t)=>{let n=e[t-1],r=e[t];n.deleted===r.deleted&&n.constructor===r.constructor&&n.mergeWith(r)&&(e.splice(t,1),r instanceof x&&r.parentSub!==null&&r.parent._map.get(r.parentSub)===r&&r.parent._map.set(r.parentSub,n))},Mc=(e,t,n)=>{for(let[r,s]of e.clients.entries()){let i=t.clients.get(r);for(let o=s.length-1;o>=0;o--){let c=s[o],l=c.clock+c.len;for(let h=rt(i,c.clock),a=i[h];h<i.length&&a.id.clock<l;a=i[++h]){let u=i[h];if(c.clock+c.len<=u.id.clock)break;u instanceof x&&u.deleted&&!u.keep&&n(u)&&u.gc(t,!1)}}}},Rc=(e,t)=>{e.clients.forEach((n,r)=>{let s=t.clients.get(r);for(let i=n.length-1;i>=0;i--){let o=n[i],c=Zn(s.length-1,1+rt(s,o.clock+o.len-1));for(let l=c,h=s[l];l>0&&h.id.clock>=o.clock;h=s[--l])mr(s,l)}})},Td=(e,t,n)=>{Mc(e,t,n),Rc(e,t)},Fc=(e,t)=>{if(t<e.length){let n=e[t],r=n.doc,s=r.store,i=n.deleteSet,o=n._mergeStructs;try{Zs(i),n.afterState=Un(n.doc.store),r.emit("beforeObserverCalls",[n,r]);let c=[];n.changed.forEach((l,h)=>c.push(()=>{(h._item===null||!h._item.deleted)&&h._callObserver(n,l)})),c.push(()=>{n.changedParentTypes.forEach((l,h)=>c.push(()=>{(h._item===null||!h._item.deleted)&&(l=l.filter(a=>a.target._item===null||!a.target._item.deleted),l.forEach(a=>{a.currentTarget=h}),l.sort((a,u)=>a.path.length-u.path.length),vc(h._dEH,l,n))})),c.push(()=>r.emit("afterTransaction",[n,r]))}),on(c,[])}finally{r.gc&&Mc(i,s,r.gcFilter),Rc(i,s),n.afterState.forEach((a,u)=>{let f=n.beforeState.get(u)||0;if(f!==a){let d=s.clients.get(u),g=vt(rt(d,f),1);for(let I=d.length-1;I>=g;I--)mr(d,I)}});for(let a=0;a<o.length;a++){let{client:u,clock:f}=o[a].id,d=s.clients.get(u),g=rt(d,f);g+1<d.length&&mr(d,g+1),g>0&&mr(d,g)}if(!n.local&&n.afterState.get(r.clientID)!==n.beforeState.get(r.clientID)&&(ur(hr,cr,"[yjs] ",lr,ar,"Changed the client-id because another client seems to be using it."),r.clientID=Ec()),r.emit("afterTransactionCleanup",[n,r]),r._observers.has("update")){let a=new Nt;bc(a,n)&&r.emit("update",[a.toUint8Array(),n.origin,r,n])}if(r._observers.has("updateV2")){let a=new gt;bc(a,n)&&r.emit("updateV2",[a.toUint8Array(),n.origin,r,n])}let{subdocsAdded:c,subdocsLoaded:l,subdocsRemoved:h}=n;(c.size>0||h.size>0||l.size>0)&&(c.forEach(a=>{a.clientID=r.clientID,a.collectionid==null&&(a.collectionid=r.collectionid),r.subdocs.add(a)}),h.forEach(a=>r.subdocs.delete(a)),r.emit("subdocs",[{loaded:l,added:c,removed:h},r,n]),h.forEach(a=>a.destroy())),e.length<=t+1?(r._transactionCleanups=[],r.emit("afterAllTransactions",[r,e])):Fc(e,t+1)}}},A=(e,t,n=null,r=!0)=>{let s=e._transactionCleanups,i=!1;e._transaction===null&&(i=!0,e._transaction=new Tr(e,n,r),s.push(e._transaction),s.length===1&&e.emit("beforeAllTransactions",[e]),e.emit("beforeTransaction",[e._transaction,e]));try{t(e._transaction)}finally{if(i){let o=e._transaction===s[0];e._transaction=null,o&&Fc(s,0)}}},Js=class{constructor(t,n){this.insertions=n,this.deletions=t,this.meta=new Map}},Uc=(e,t,n)=>{Wt(e,n.deletions,r=>{r instanceof x&&t.scope.some(s=>wn(s,r))&&hi(r,!1)})},_c=(e,t,n)=>{let r=null,s=null,i=e.doc,o=e.scope;if(A(i,c=>{for(;t.length>0&&r===null;){let l=i.store,h=t.pop(),a=new Set,u=[],f=!1;Wt(c,h.insertions,d=>{if(d instanceof x){if(d.redone!==null){let{item:g,diff:I}=Ws(l,d.id);I>0&&(g=G(c,y(g.id.client,g.id.clock+I))),d=g}!d.deleted&&o.some(g=>wn(g,d))&&u.push(d)}}),Wt(c,h.deletions,d=>{d instanceof x&&o.some(g=>wn(g,d))&&!je(h.insertions,d.id)&&a.add(d)}),a.forEach(d=>{f=ul(c,d,a,h.insertions,e.ignoreRemoteMapChanges)!==null||f});for(let d=u.length-1;d>=0;d--){let g=u[d];e.deleteFilter(g)&&(g.delete(c),f=!0)}r=f?h:null}c.changed.forEach((l,h)=>{l.has(null)&&h._searchMarker&&(h._searchMarker.length=0)}),s=c},e),r!=null){let c=s.changedParentTypes;e.emit("stack-item-popped",[{stackItem:r,type:n,changedParentTypes:c},e])}return r},Hs=class extends xe{constructor(t,{captureTimeout:n=500,captureTransaction:r=l=>!0,deleteFilter:s=()=>!0,trackedOrigins:i=new Set([null]),ignoreRemoteMapChanges:o=!1,doc:c=Ts(t)?t[0].doc:t.doc}={}){super(),this.scope=[],this.addToScope(t),this.deleteFilter=s,i.add(this),this.trackedOrigins=i,this.captureTransaction=r,this.undoStack=[],this.redoStack=[],this.undoing=!1,this.redoing=!1,this.doc=c,this.lastChange=0,this.ignoreRemoteMapChanges=o,this.captureTimeout=n,this.afterTransactionHandler=l=>{if(!this.captureTransaction(l)||!this.scope.some(S=>l.changedParentTypes.has(S))||!this.trackedOrigins.has(l.origin)&&(!l.origin||!this.trackedOrigins.has(l.origin.constructor)))return;let h=this.undoing,a=this.redoing,u=h?this.redoStack:this.undoStack;h?this.stopCapturing():a||this.clear(!1,!0);let f=new Kt;l.afterState.forEach((S,Dt)=>{let tn=l.beforeState.get(Dt)||0,Hn=S-tn;Hn>0&&mn(f,Dt,tn,Hn)});let d=or(),g=!1;if(this.lastChange>0&&d-this.lastChange<this.captureTimeout&&u.length>0&&!h&&!a){let S=u[u.length-1];S.deletions=pn([S.deletions,l.deleteSet]),S.insertions=pn([S.insertions,f])}else u.push(new Js(l.deleteSet,f)),g=!0;!h&&!a&&(this.lastChange=d),Wt(l,l.deleteSet,S=>{S instanceof x&&this.scope.some(Dt=>wn(Dt,S))&&hi(S,!0)});let I=[{stackItem:u[u.length-1],origin:l.origin,type:h?"redo":"undo",changedParentTypes:l.changedParentTypes},this];g?this.emit("stack-item-added",I):this.emit("stack-item-updated",I)},this.doc.on("afterTransaction",this.afterTransactionHandler),this.doc.on("destroy",()=>{this.destroy()})}addToScope(t){t=Ts(t)?t:[t],t.forEach(n=>{this.scope.every(r=>r!==n)&&this.scope.push(n)})}addTrackedOrigin(t){this.trackedOrigins.add(t)}removeTrackedOrigin(t){this.trackedOrigins.delete(t)}clear(t=!0,n=!0){(t&&this.canUndo()||n&&this.canRedo())&&this.doc.transact(r=>{t&&(this.undoStack.forEach(s=>Uc(r,this,s)),this.undoStack=[]),n&&(this.redoStack.forEach(s=>Uc(r,this,s)),this.redoStack=[]),this.emit("stack-cleared",[{undoStackCleared:t,redoStackCleared:n}])})}stopCapturing(){this.lastChange=0}undo(){this.undoing=!0;let t;try{t=_c(this,this.undoStack,"undo")}finally{this.undoing=!1}return t}redo(){this.redoing=!0;let t;try{t=_c(this,this.redoStack,"redo")}finally{this.redoing=!1}return t}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}destroy(){this.trackedOrigins.delete(this),this.doc.off("afterTransaction",this.afterTransactionHandler),super.destroy()}};Lt=class{constructor(t,n){this.gen=bd(t),this.curr=null,this.done=!1,this.filterSkips=n,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===J);return this.curr}},Bd=e=>qc(e,ft),qc=(e,t=nt)=>{let n=[],r=new t(z(e)),s=new Lt(r,!1);for(let o=s.curr;o!==null;o=s.next())n.push(o);ur("Structs: ",n);let i=Xt(r);ur("DeleteSet: ",i)},Ud=e=>jc(e,ft),jc=(e,t=nt)=>{let n=[],r=new t(z(e)),s=new Lt(r,!1);for(let i=s.curr;i!==null;i=s.next())n.push(i);return{structs:n,ds:Xt(r)}},In=class{constructor(t){this.currClient=0,this.startClock=0,this.written=0,this.encoder=t,this.clientStructs=[]}},Pc=e=>Sn(e,ft,Nt),zc=(e,t=Re,n=nt)=>{let r=new t,s=new Lt(new n(z(e)),!1),i=s.curr;if(i!==null){let o=0,c=i.id.client,l=i.id.clock!==0,h=l?0:i.id.clock+i.length;for(;i!==null;i=s.next())c!==i.id.client&&(h!==0&&(o++,w(r.restEncoder,c),w(r.restEncoder,h)),c=i.id.client,h=0,l=i.id.clock!==0),i.constructor===J&&(l=!0),l||(h=i.id.clock+i.length);h!==0&&(o++,w(r.restEncoder,c),w(r.restEncoder,h));let a=fe();return w(a,o),zo(a,r.restEncoder),r.restEncoder=a,r.toUint8Array()}else return w(r.restEncoder,0),r.toUint8Array()},_d=e=>zc(e,Zt,ft),Gc=(e,t=nt)=>{let n=new Map,r=new Map,s=new Lt(new t(z(e)),!1),i=s.curr;if(i!==null){let o=i.id.client,c=i.id.clock;for(n.set(o,c);i!==null;i=s.next())o!==i.id.client&&(r.set(o,c),n.set(i.id.client,i.id.clock),o=i.id.client),c=i.id.clock+i.length;r.set(o,c)}return{from:n,to:r}},xd=e=>Gc(e,ft),kd=(e,t)=>{if(e.constructor===$){let{client:n,clock:r}=e.id;return new $(y(n,r+t),e.length-t)}else if(e.constructor===J){let{client:n,clock:r}=e.id;return new J(y(n,r+t),e.length-t)}else{let n=e,{client:r,clock:s}=n.id;return new x(y(r,s+t),null,y(r,s+t-1),null,n.rightOrigin,n.parent,n.parentSub,n.content.splice(t))}},Sn=(e,t=nt,n=gt)=>{if(e.length===1)return e[0];let r=e.map(a=>new t(z(a))),s=r.map(a=>new Lt(a,!0)),i=null,o=new n,c=new In(o);for(;s=s.filter(f=>f.curr!==null),s.sort((f,d)=>{if(f.curr.id.client===d.curr.id.client){let g=f.curr.id.clock-d.curr.id.clock;return g===0?f.curr.constructor===d.curr.constructor?0:f.curr.constructor===J?1:-1:g}else return d.curr.id.client-f.curr.id.client}),s.length!==0;){let a=s[0],u=a.curr.id.client;if(i!==null){let f=a.curr,d=!1;for(;f!==null&&f.id.clock+f.length<=i.struct.id.clock+i.struct.length&&f.id.client>=i.struct.id.client;)f=a.next(),d=!0;if(f===null||f.id.client!==u||d&&f.id.clock>i.struct.id.clock+i.struct.length)continue;if(u!==i.struct.id.client)Jt(c,i.struct,i.offset),i={struct:f,offset:0},a.next();else if(i.struct.id.clock+i.struct.length<f.id.clock)if(i.struct.constructor===J)i.struct.length=f.id.clock+f.length-i.struct.id.clock;else{Jt(c,i.struct,i.offset);let g=f.id.clock-i.struct.id.clock-i.struct.length;i={struct:new J(y(u,i.struct.id.clock+i.struct.length),g),offset:0}}else{let g=i.struct.id.clock+i.struct.length-f.id.clock;g>0&&(i.struct.constructor===J?i.struct.length-=g:f=kd(f,g)),i.struct.mergeWith(f)||(Jt(c,i.struct,i.offset),i={struct:f,offset:0},a.next())}}else i={struct:a.curr,offset:0},a.next();for(let f=a.curr;f!==null&&f.id.client===u&&f.id.clock===i.struct.id.clock+i.struct.length&&f.constructor!==J;f=a.next())Jt(c,i.struct,i.offset),i={struct:f,offset:0}}i!==null&&(Jt(c,i.struct,i.offset),i=null),oi(c);let l=r.map(a=>Xt(a)),h=pn(l);return bt(o,h),o.toUint8Array()},ii=(e,t,n=nt,r=gt)=>{let s=ei(t),i=new r,o=new In(i),c=new n(z(e)),l=new Lt(c,!1);for(;l.curr;){let a=l.curr,u=a.id.client,f=s.get(u)||0;if(l.curr.constructor===J){l.next();continue}if(a.id.clock+a.length>f)for(Jt(o,a,vt(f-a.id.clock,0)),l.next();l.curr&&l.curr.id.client===u;)Jt(o,l.curr,0),l.next();else for(;l.curr&&l.curr.id.client===u&&l.curr.id.clock+l.curr.length<=f;)l.next()}oi(o);let h=Xt(c);return bt(i,h),i.toUint8Array()},Ad=(e,t)=>ii(e,t,ft,Nt),$c=e=>{e.written>0&&(e.clientStructs.push({written:e.written,restEncoder:Z(e.encoder.restEncoder)}),e.encoder.restEncoder=fe(),e.written=0)},Jt=(e,t,n)=>{e.written>0&&e.currClient!==t.id.client&&$c(e),e.written===0&&(e.currClient=t.id.client,e.encoder.writeClient(t.id.client),w(e.encoder.restEncoder,t.id.clock+n)),t.write(e.encoder,n),e.written++},oi=e=>{$c(e);let t=e.encoder.restEncoder;w(t,e.clientStructs.length);for(let n=0;n<e.clientStructs.length;n++){let r=e.clientStructs[n];w(t,r.written),Me(t,r.restEncoder)}},Jc=(e,t,n)=>{let r=new t(z(e)),s=new Lt(r,!1),i=new n,o=new In(i);for(let l=s.curr;l!==null;l=s.next())Jt(o,l,0);oi(o);let c=Xt(r);return bt(i,c),i.toUint8Array()},Ed=e=>Jc(e,ft,gt),Hc=e=>Jc(e,nt,Nt),ye=class{constructor(t,n){this.target=t,this.currentTarget=t,this.transaction=n,this._changes=null,this._keys=null,this._delta=null}get path(){return Cd(this.currentTarget,this.target)}deletes(t){return je(this.transaction.deleteSet,t.id)}get keys(){if(this._keys===null){let t=new Map,n=this.target;this.transaction.changed.get(n).forEach(s=>{if(s!==null){let i=n._map.get(s),o,c;if(this.adds(i)){let l=i.left;for(;l!==null&&this.adds(l);)l=l.left;if(this.deletes(i))if(l!==null&&this.deletes(l))o="delete",c=Wn(l.content.getContent());else return;else l!==null&&this.deletes(l)?(o="update",c=Wn(l.content.getContent())):(o="add",c=void 0)}else if(this.deletes(i))o="delete",c=Wn(i.content.getContent());else return;t.set(s,{action:o,oldValue:c})}}),this._keys=t}return this._keys}get delta(){return this.changes.delta}adds(t){return t.id.clock>=(this.transaction.beforeState.get(t.id.client)||0)}get changes(){let t=this._changes;if(t===null){let n=this.target,r=ce(),s=ce(),i=[];if(t={added:r,deleted:s,delta:i,keys:this.keys},this.transaction.changed.get(n).has(null)){let c=null,l=()=>{c&&i.push(c)};for(let h=n._start;h!==null;h=h.right)h.deleted?this.deletes(h)&&!this.adds(h)&&((c===null||c.delete===void 0)&&(l(),c={delete:0}),c.delete+=h.length,s.add(h)):this.adds(h)?((c===null||c.insert===void 0)&&(l(),c={insert:[]}),c.insert=c.insert.concat(h.content.getContent()),r.add(h)):((c===null||c.retain===void 0)&&(l(),c={retain:0}),c.retain+=h.length);c!==null&&c.retain===void 0&&l()}this._changes=t}return t}},Cd=(e,t)=>{let n=[];for(;t._item!==null&&t!==e;){if(t._item.parentSub!==null)n.unshift(t._item.parentSub);else{let r=0,s=t._item.parent._start;for(;s!==t._item&&s!==null;)s.deleted||r++,s=s.right;n.unshift(r)}t=t._item.parent}return n},Kc=80,ci=0,Ks=class{constructor(t,n){t.marker=!0,this.p=t,this.index=n,this.timestamp=ci++}},Dd=e=>{e.timestamp=ci++},Wc=(e,t,n)=>{e.p.marker=!1,e.p=t,t.marker=!0,e.index=n,e.timestamp=ci++},vd=(e,t,n)=>{if(e.length>=Kc){let r=e.reduce((s,i)=>s.timestamp<i.timestamp?s:i);return Wc(r,t,n),r}else{let r=new Ks(t,n);return e.push(r),r}},Dr=(e,t)=>{if(e._start===null||t===0||e._searchMarker===null)return null;let n=e._searchMarker.length===0?null:e._searchMarker.reduce((i,o)=>ke(t-i.index)<ke(t-o.index)?i:o),r=e._start,s=0;for(n!==null&&(r=n.p,s=n.index,Dd(n));r.right!==null&&s<t;){if(!r.deleted&&r.countable){if(t<s+r.length)break;s+=r.length}r=r.right}for(;r.left!==null&&s>t;)r=r.left,!r.deleted&&r.countable&&(s-=r.length);for(;r.left!==null&&r.left.id.client===r.id.client&&r.left.id.clock+r.left.length===r.id.clock;)r=r.left,!r.deleted&&r.countable&&(s-=r.length);return n!==null&&ke(n.index-s)<r.parent.length/Kc?(Wc(n,r,s),n):vd(e._searchMarker,r,s)},Tn=(e,t,n)=>{for(let r=e.length-1;r>=0;r--){let s=e[r];if(n>0){let i=s.p;for(i.marker=!1;i&&(i.deleted||!i.countable);)i=i.left,i&&!i.deleted&&i.countable&&(s.index-=i.length);if(i===null||i.marker===!0){e.splice(r,1);continue}s.p=i,i.marker=!0}(t<s.index||n>0&&t===s.index)&&(s.index=vt(t,s.index+n))}},Vd=e=>{let t=e._start,n=[];for(;t;)n.push(t),t=t.right;return n},vr=(e,t,n)=>{let r=e,s=t.changedParentTypes;for(;yt(s,e,()=>[]).push(n),e._item!==null;)e=e._item.parent;vc(r._eH,n,t)},L=class{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=mc(),this._dEH=mc(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(t,n){this.doc=t,this._item=n}_copy(){throw ut()}clone(){throw ut()}_write(t){}get _first(){let t=this._start;for(;t!==null&&t.deleted;)t=t.right;return t}_callObserver(t,n){!t.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(t){wc(this._eH,t)}observeDeep(t){wc(this._dEH,t)}unobserve(t){yc(this._eH,t)}unobserveDeep(t){yc(this._dEH,t)}toJSON(){}},Xc=(e,t,n)=>{t<0&&(t=e._length+t),n<0&&(n=e._length+n);let r=n-t,s=[],i=e._start;for(;i!==null&&r>0;){if(i.countable&&!i.deleted){let o=i.content.getContent();if(o.length<=t)t-=o.length;else{for(let c=t;c<o.length&&r>0;c++)s.push(o[c]),r--;t=0}}i=i.right}return s},Zc=e=>{let t=[],n=e._start;for(;n!==null;){if(n.countable&&!n.deleted){let r=n.content.getContent();for(let s=0;s<r.length;s++)t.push(r[s])}n=n.right}return t},Od=(e,t)=>{let n=[],r=e._start;for(;r!==null;){if(r.countable&&pe(r,t)){let s=r.content.getContent();for(let i=0;i<s.length;i++)n.push(s[i])}r=r.right}return n},bn=(e,t)=>{let n=0,r=e._start;for(;r!==null;){if(r.countable&&!r.deleted){let s=r.content.getContent();for(let i=0;i<s.length;i++)t(s[i],n++,e)}r=r.right}},Yc=(e,t)=>{let n=[];return bn(e,(r,s)=>{n.push(t(r,s,e))}),n},Nd=e=>{let t=e._start,n=null,r=0;return{[Symbol.iterator](){return this},next:()=>{if(n===null){for(;t!==null&&t.deleted;)t=t.right;if(t===null)return{done:!0,value:void 0};n=t.content.getContent(),r=0,t=t.right}let s=n[r++];return n.length<=r&&(n=null),{done:!1,value:s}}}},Qc=(e,t)=>{let n=Dr(e,t),r=e._start;for(n!==null&&(r=n.p,t-=n.index);r!==null;r=r.right)if(!r.deleted&&r.countable){if(t<r.length)return r.content.getContent()[t];t-=r.length}},br=(e,t,n,r)=>{let s=n,i=e.doc,o=i.clientID,c=i.store,l=n===null?t._start:n.right,h=[],a=()=>{h.length>0&&(s=new x(y(o,v(c,o)),s,s&&s.lastId,l,l&&l.id,t,null,new xt(h)),s.integrate(e,0),h=[])};r.forEach(u=>{if(u===null)h.push(u);else switch(u.constructor){case Number:case Object:case Boolean:case Array:case String:h.push(u);break;default:switch(a(),u.constructor){case Uint8Array:case ArrayBuffer:s=new x(y(o,v(c,o)),s,s&&s.lastId,l,l&&l.id,t,null,new Qt(new Uint8Array(u))),s.integrate(e,0);break;case Ot:s=new x(y(o,v(c,o)),s,s&&s.lastId,l,l&&l.id,t,null,new Te(u)),s.integrate(e,0);break;default:if(u instanceof L)s=new x(y(o,v(c,o)),s,s&&s.lastId,l,l&&l.id,t,null,new Q(u)),s.integrate(e,0);else throw new Error("Unexpected content type in insert operation")}}}),a()},tl=Pt("Length exceeded!"),el=(e,t,n,r)=>{if(n>t._length)throw tl;if(n===0)return t._searchMarker&&Tn(t._searchMarker,n,r.length),br(e,t,null,r);let s=n,i=Dr(t,n),o=t._start;for(i!==null&&(o=i.p,n-=i.index,n===0&&(o=o.prev,n+=o&&o.countable&&!o.deleted?o.length:0));o!==null;o=o.right)if(!o.deleted&&o.countable){if(n<=o.length){n<o.length&&G(e,y(o.id.client,o.id.clock+n));break}n-=o.length}return t._searchMarker&&Tn(t._searchMarker,s,r.length),br(e,t,o,r)},Ld=(e,t,n)=>{let s=(t._searchMarker||[]).reduce((i,o)=>o.index>i.index?o:i,{index:0,p:t._start}).p;if(s)for(;s.right;)s=s.right;return br(e,t,s,n)},nl=(e,t,n,r)=>{if(r===0)return;let s=n,i=r,o=Dr(t,n),c=t._start;for(o!==null&&(c=o.p,n-=o.index);c!==null&&n>0;c=c.right)!c.deleted&&c.countable&&(n<c.length&&G(e,y(c.id.client,c.id.clock+n)),n-=c.length);for(;r>0&&c!==null;)c.deleted||(r<c.length&&G(e,y(c.id.client,c.id.clock+r)),c.delete(e),r-=c.length),c=c.right;if(r>0)throw tl;t._searchMarker&&Tn(t._searchMarker,s,-i+r)},Br=(e,t,n)=>{let r=t._map.get(n);r!==void 0&&r.delete(e)},li=(e,t,n,r)=>{let s=t._map.get(n)||null,i=e.doc,o=i.clientID,c;if(r==null)c=new xt([r]);else switch(r.constructor){case Number:case Object:case Boolean:case Array:case String:c=new xt([r]);break;case Uint8Array:c=new Qt(r);break;case Ot:c=new Te(r);break;default:if(r instanceof L)c=new Q(r);else throw new Error("Unexpected content type")}new x(y(o,v(i.store,o)),s,s&&s.lastId,null,null,t,n,c).integrate(e,0)},ai=(e,t)=>{let n=e._map.get(t);return n!==void 0&&!n.deleted?n.content.getContent()[n.length-1]:void 0},rl=e=>{let t={};return e._map.forEach((n,r)=>{n.deleted||(t[r]=n.content.getContent()[n.length-1])}),t},sl=(e,t)=>{let n=e._map.get(t);return n!==void 0&&!n.deleted},Md=(e,t,n)=>{let r=e._map.get(t)||null;for(;r!==null&&(!n.sv.has(r.id.client)||r.id.clock>=(n.sv.get(r.id.client)||0));)r=r.left;return r!==null&&pe(r,n)?r.content.getContent()[r.length-1]:void 0},gr=e=>uc(e.entries(),t=>!t[1].deleted),Ur=class extends ye{constructor(t,n){super(t,n),this._transaction=n}},dt=class extends L{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(t){let n=new dt;return n.push(t),n}_integrate(t,n){super._integrate(t,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new dt}clone(){let t=new dt;return t.insert(0,this.toArray().map(n=>n instanceof L?n.clone():n)),t}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}_callObserver(t,n){super._callObserver(t,n),vr(this,t,new Ur(this,t))}insert(t,n){this.doc!==null?A(this.doc,r=>{el(r,this,t,n)}):this._prelimContent.splice(t,0,...n)}push(t){this.doc!==null?A(this.doc,n=>{Ld(n,this,t)}):this._prelimContent.push(...t)}unshift(t){this.insert(0,t)}delete(t,n=1){this.doc!==null?A(this.doc,r=>{nl(r,this,t,n)}):this._prelimContent.splice(t,n)}get(t){return Qc(this,t)}toArray(){return Zc(this)}slice(t=0,n=this.length){return Xc(this,t,n)}toJSON(){return this.map(t=>t instanceof L?t.toJSON():t)}map(t){return Yc(this,t)}forEach(t){bn(this,t)}[Symbol.iterator](){return Nd(this)}_write(t){t.writeTypeRef(nf)}},Rd=e=>new dt,_r=class extends ye{constructor(t,n,r){super(t,n),this.keysChanged=r}},Bt=class extends L{constructor(t){super(),this._prelimContent=null,t===void 0?this._prelimContent=new Map:this._prelimContent=new Map(t)}_integrate(t,n){super._integrate(t,n),this._prelimContent.forEach((r,s)=>{this.set(s,r)}),this._prelimContent=null}_copy(){return new Bt}clone(){let t=new Bt;return this.forEach((n,r)=>{t.set(r,n instanceof L?n.clone():n)}),t}_callObserver(t,n){vr(this,t,new _r(this,t,n))}toJSON(){let t={};return this._map.forEach((n,r)=>{if(!n.deleted){let s=n.content.getContent()[n.length-1];t[r]=s instanceof L?s.toJSON():s}}),t}get size(){return[...gr(this._map)].length}keys(){return dr(gr(this._map),t=>t[0])}values(){return dr(gr(this._map),t=>t[1].content.getContent()[t[1].length-1])}entries(){return dr(gr(this._map),t=>[t[0],t[1].content.getContent()[t[1].length-1]])}forEach(t){this._map.forEach((n,r)=>{n.deleted||t(n.content.getContent()[n.length-1],r,this)})}[Symbol.iterator](){return this.entries()}delete(t){this.doc!==null?A(this.doc,n=>{Br(n,this,t)}):this._prelimContent.delete(t)}set(t,n){return this.doc!==null?A(this.doc,r=>{li(r,this,t,n)}):this._prelimContent.set(t,n),n}get(t){return ai(this,t)}has(t){return sl(this,t)}clear(){this.doc!==null?A(this.doc,t=>{this.forEach(function(n,r,s){Br(t,s,r)})}):this._prelimContent.clear()}_write(t){t.writeTypeRef(rf)}},Fd=e=>new Bt,Ht=(e,t)=>e===t||typeof e=="object"&&typeof t=="object"&&e&&t&&_o(e,t),Bn=class{constructor(t,n,r,s){this.left=t,this.right=n,this.index=r,this.currentAttributes=s}forward(){switch(this.right===null&&X(),this.right.content.constructor){case O:this.right.deleted||Pe(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}},xc=(e,t,n)=>{for(;t.right!==null&&n>0;){switch(t.right.content.constructor){case O:t.right.deleted||Pe(t.currentAttributes,t.right.content);break;default:t.right.deleted||(n<t.right.length&&G(e,y(t.right.id.client,t.right.id.clock+n)),t.index+=t.right.length,n-=t.right.length);break}t.left=t.right,t.right=t.right.right}return t},pr=(e,t,n)=>{let r=new Map,s=Dr(t,n);if(s){let i=new Bn(s.p.left,s.p,s.index,r);return xc(e,i,n-s.index)}else{let i=new Bn(null,t._start,0,r);return xc(e,i,n)}},il=(e,t,n,r)=>{for(;n.right!==null&&(n.right.deleted===!0||n.right.content.constructor===O&&Ht(r.get(n.right.content.key),n.right.content.value));)n.right.deleted||r.delete(n.right.content.key),n.forward();let s=e.doc,i=s.clientID;r.forEach((o,c)=>{let l=n.left,h=n.right,a=new x(y(i,v(s.store,i)),l,l&&l.lastId,h,h&&h.id,t,null,new O(c,o));a.integrate(e,0),n.right=a,n.forward()})},Pe=(e,t)=>{let{key:n,value:r}=t;r===null?e.delete(n):e.set(n,r)},ol=(e,t)=>{for(;e.right!==null;){if(!(e.right.deleted||e.right.content.constructor===O&&Ht(t[e.right.content.key]||null,e.right.content.value)))break;e.forward()}},cl=(e,t,n,r)=>{let s=e.doc,i=s.clientID,o=new Map;for(let c in r){let l=r[c],h=n.currentAttributes.get(c)||null;if(!Ht(h,l)){o.set(c,h);let{left:a,right:u}=n;n.right=new x(y(i,v(s.store,i)),a,a&&a.lastId,u,u&&u.id,t,null,new O(c,l)),n.right.integrate(e,0),n.forward()}}return o},qs=(e,t,n,r,s)=>{n.currentAttributes.forEach((f,d)=>{s[d]===void 0&&(s[d]=null)});let i=e.doc,o=i.clientID;ol(n,s);let c=cl(e,t,n,s),l=r.constructor===String?new Y(r):r instanceof L?new Q(r):new _t(r),{left:h,right:a,index:u}=n;t._searchMarker&&Tn(t._searchMarker,n.index,l.getLength()),a=new x(y(o,v(i.store,o)),h,h&&h.lastId,a,a&&a.id,t,null,l),a.integrate(e,0),n.right=a,n.index=u,n.forward(),il(e,t,n,c)},kc=(e,t,n,r,s)=>{let i=e.doc,o=i.clientID;ol(n,s);let c=cl(e,t,n,s);t:for(;n.right!==null&&(r>0||c.size>0&&(n.right.deleted||n.right.content.constructor===O));){if(!n.right.deleted)switch(n.right.content.constructor){case O:{let{key:l,value:h}=n.right.content,a=s[l];if(a!==void 0){if(Ht(a,h))c.delete(l);else{if(r===0)break t;c.set(l,h)}n.right.delete(e)}else n.currentAttributes.set(l,h);break}default:r<n.right.length&&G(e,y(n.right.id.client,n.right.id.clock+r)),r-=n.right.length;break}n.forward()}if(r>0){let l="";for(;r>0;r--)l+=`
`;n.right=new x(y(o,v(i.store,o)),n.left,n.left&&n.left.lastId,n.right,n.right&&n.right.id,t,null,new Y(l)),n.right.integrate(e,0),n.forward()}il(e,t,n,c)},ll=(e,t,n,r,s)=>{let i=n,o=nn(s);for(;i&&(!i.countable||i.deleted);)!i.deleted&&i.content.constructor===O&&Pe(o,i.content),i=i.right;let c=0,l=!1;for(;t!==i;){if(n===t&&(l=!0),!t.deleted){let h=t.content;switch(h.constructor){case O:{let{key:a,value:u}=h;((o.get(a)||null)!==u||(r.get(a)||null)===u)&&(t.delete(e),c++,!l&&(s.get(a)||null)===u&&(r.get(a)||null)!==u&&s.delete(a));break}}}t=t.right}return c},qd=(e,t)=>{for(;t&&t.right&&(t.right.deleted||!t.right.countable);)t=t.right;let n=new Set;for(;t&&(t.deleted||!t.countable);){if(!t.deleted&&t.content.constructor===O){let r=t.content.key;n.has(r)?t.delete(e):n.add(r)}t=t.left}},al=e=>{let t=0;return A(e.doc,n=>{let r=e._start,s=e._start,i=H(),o=nn(i);for(;s;){if(s.deleted===!1)switch(s.content.constructor){case O:Pe(o,s.content);break;default:t+=ll(n,r,s,i,o),i=nn(o),r=s;break}s=s.right}}),t},Ac=(e,t,n)=>{let r=n,s=nn(t.currentAttributes),i=t.right;for(;n>0&&t.right!==null;){if(t.right.deleted===!1)switch(t.right.content.constructor){case Q:case _t:case Y:n<t.right.length&&G(e,y(t.right.id.client,t.right.id.clock+n)),n-=t.right.length,t.right.delete(e);break}t.forward()}i&&ll(e,i,t.right,s,t.currentAttributes);let o=(t.left||t.right).parent;return o._searchMarker&&Tn(o._searchMarker,t.index,-r+n),t},xr=class extends ye{constructor(t,n,r){super(t,n),this.childListChanged=!1,this.keysChanged=new Set,r.forEach(s=>{s===null?this.childListChanged=!0:this.keysChanged.add(s)})}get changes(){if(this._changes===null){let t={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=t}return this._changes}get delta(){if(this._delta===null){let t=this.target.doc,n=[];A(t,r=>{let s=new Map,i=new Map,o=this.target._start,c=null,l={},h="",a=0,u=0,f=()=>{if(c!==null){let d;switch(c){case"delete":d={delete:u},u=0;break;case"insert":d={insert:h},s.size>0&&(d.attributes={},s.forEach((g,I)=>{g!==null&&(d.attributes[I]=g)})),h="";break;case"retain":if(d={retain:a},Object.keys(l).length>0){d.attributes={};for(let g in l)d.attributes[g]=l[g]}a=0;break}n.push(d),c=null}};for(;o!==null;){switch(o.content.constructor){case Q:case _t:this.adds(o)?this.deletes(o)||(f(),c="insert",h=o.content.getContent()[0],f()):this.deletes(o)?(c!=="delete"&&(f(),c="delete"),u+=1):o.deleted||(c!=="retain"&&(f(),c="retain"),a+=1);break;case Y:this.adds(o)?this.deletes(o)||(c!=="insert"&&(f(),c="insert"),h+=o.content.str):this.deletes(o)?(c!=="delete"&&(f(),c="delete"),u+=o.length):o.deleted||(c!=="retain"&&(f(),c="retain"),a+=o.length);break;case O:{let{key:d,value:g}=o.content;if(this.adds(o)){if(!this.deletes(o)){let I=s.get(d)||null;Ht(I,g)?g!==null&&o.delete(r):(c==="retain"&&f(),Ht(g,i.get(d)||null)?delete l[d]:l[d]=g)}}else if(this.deletes(o)){i.set(d,g);let I=s.get(d)||null;Ht(I,g)||(c==="retain"&&f(),l[d]=I)}else if(!o.deleted){i.set(d,g);let I=l[d];I!==void 0&&(Ht(I,g)?I!==null&&o.delete(r):(c==="retain"&&f(),g===null?delete l[d]:l[d]=g))}o.deleted||(c==="insert"&&f(),Pe(s,o.content));break}}o=o.right}for(f();n.length>0;){let d=n[n.length-1];if(d.retain!==void 0&&d.attributes===void 0)n.pop();else break}}),this._delta=n}return this._delta}},Mt=class extends L{constructor(t){super(),this._pending=t!==void 0?[()=>this.insert(0,t)]:[],this._searchMarker=[]}get length(){return this._length}_integrate(t,n){super._integrate(t,n);try{this._pending.forEach(r=>r())}catch(r){console.error(r)}this._pending=null}_copy(){return new Mt}clone(){let t=new Mt;return t.applyDelta(this.toDelta()),t}_callObserver(t,n){super._callObserver(t,n);let r=new xr(this,t,n),s=t.doc;if(vr(this,t,r),!t.local){let i=!1;for(let[o,c]of t.afterState.entries()){let l=t.beforeState.get(o)||0;if(c!==l&&(Lc(t,s.store.clients.get(o),l,c,h=>{!h.deleted&&h.content.constructor===O&&(i=!0)}),i))break}i||Wt(t,t.deleteSet,o=>{o instanceof $||i||o.parent===this&&o.content.constructor===O&&(i=!0)}),A(s,o=>{i?al(this):Wt(o,o.deleteSet,c=>{c instanceof $||c.parent===this&&qd(o,c)})})}}toString(){let t="",n=this._start;for(;n!==null;)!n.deleted&&n.countable&&n.content.constructor===Y&&(t+=n.content.str),n=n.right;return t}toJSON(){return this.toString()}applyDelta(t,{sanitize:n=!0}={}){this.doc!==null?A(this.doc,r=>{let s=new Bn(null,this._start,0,new Map);for(let i=0;i<t.length;i++){let o=t[i];if(o.insert!==void 0){let c=!n&&typeof o.insert=="string"&&i===t.length-1&&s.right===null&&o.insert.slice(-1)===`
`?o.insert.slice(0,-1):o.insert;(typeof c!="string"||c.length>0)&&qs(r,this,s,c,o.attributes||{})}else o.retain!==void 0?kc(r,this,s,o.retain,o.attributes||{}):o.delete!==void 0&&Ac(r,s,o.delete)}}):this._pending.push(()=>this.applyDelta(t))}toDelta(t,n,r){let s=[],i=new Map,o=this.doc,c="",l=this._start;function h(){if(c.length>0){let a={},u=!1;i.forEach((d,g)=>{u=!0,a[g]=d});let f={insert:c};u&&(f.attributes=a),s.push(f),c=""}}return A(o,a=>{for(t&&Gs(a,t),n&&Gs(a,n);l!==null;){if(pe(l,t)||n!==void 0&&pe(l,n))switch(l.content.constructor){case Y:{let u=i.get("ychange");t!==void 0&&!pe(l,t)?(u===void 0||u.user!==l.id.client||u.type!=="removed")&&(h(),i.set("ychange",r?r("removed",l.id):{type:"removed"})):n!==void 0&&!pe(l,n)?(u===void 0||u.user!==l.id.client||u.type!=="added")&&(h(),i.set("ychange",r?r("added",l.id):{type:"added"})):u!==void 0&&(h(),i.delete("ychange")),c+=l.content.str;break}case Q:case _t:{h();let u={insert:l.content.getContent()[0]};if(i.size>0){let f={};u.attributes=f,i.forEach((d,g)=>{f[g]=d})}s.push(u);break}case O:pe(l,t)&&(h(),Pe(i,l.content));break}l=l.right}h()},"cleanup"),s}insert(t,n,r){if(n.length<=0)return;let s=this.doc;s!==null?A(s,i=>{let o=pr(i,this,t);r||(r={},o.currentAttributes.forEach((c,l)=>{r[l]=c})),qs(i,this,o,n,r)}):this._pending.push(()=>this.insert(t,n,r))}insertEmbed(t,n,r={}){let s=this.doc;s!==null?A(s,i=>{let o=pr(i,this,t);qs(i,this,o,n,r)}):this._pending.push(()=>this.insertEmbed(t,n,r))}delete(t,n){if(n===0)return;let r=this.doc;r!==null?A(r,s=>{Ac(s,pr(s,this,t),n)}):this._pending.push(()=>this.delete(t,n))}format(t,n,r){if(n===0)return;let s=this.doc;s!==null?A(s,i=>{let o=pr(i,this,t);o.right!==null&&kc(i,this,o,n,r)}):this._pending.push(()=>this.format(t,n,r))}removeAttribute(t){this.doc!==null?A(this.doc,n=>{Br(n,this,t)}):this._pending.push(()=>this.removeAttribute(t))}setAttribute(t,n){this.doc!==null?A(this.doc,r=>{li(r,this,t,n)}):this._pending.push(()=>this.setAttribute(t,n))}getAttribute(t){return ai(this,t)}getAttributes(t){return rl(this)}_write(t){t.writeTypeRef(sf)}},jd=e=>new Mt,fn=class{constructor(t,n=()=>!0){this._filter=n,this._root=t,this._currentNode=t._start,this._firstCall=!0}[Symbol.iterator](){return this}next(){let t=this._currentNode,n=t&&t.content&&t.content.type;if(t!==null&&(!this._firstCall||t.deleted||!this._filter(n)))do if(n=t.content.type,!t.deleted&&(n.constructor===Yt||n.constructor===Ut)&&n._start!==null)t=n._start;else for(;t!==null;)if(t.right!==null){t=t.right;break}else t.parent===this._root?t=null:t=t.parent._item;while(t!==null&&(t.deleted||!this._filter(t.content.type)));return this._firstCall=!1,t===null?{value:void 0,done:!0}:(this._currentNode=t,{value:t.content.type,done:!1})}},Ut=class extends L{constructor(){super(),this._prelimContent=[]}get firstChild(){let t=this._first;return t?t.content.getContent()[0]:null}_integrate(t,n){super._integrate(t,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new Ut}clone(){let t=new Ut;return t.insert(0,this.toArray().map(n=>n instanceof L?n.clone():n)),t}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(t){return new fn(this,t)}querySelector(t){t=t.toUpperCase();let r=new fn(this,s=>s.nodeName&&s.nodeName.toUpperCase()===t).next();return r.done?null:r.value}querySelectorAll(t){return t=t.toUpperCase(),Array.from(new fn(this,n=>n.nodeName&&n.nodeName.toUpperCase()===t))}_callObserver(t,n){vr(this,t,new kr(this,n,t))}toString(){return Yc(this,t=>t.toString()).join("")}toJSON(){return this.toString()}toDOM(t=document,n={},r){let s=t.createDocumentFragment();return r!==void 0&&r._createAssociation(s,this),bn(this,i=>{s.insertBefore(i.toDOM(t,n,r),null)}),s}insert(t,n){this.doc!==null?A(this.doc,r=>{el(r,this,t,n)}):this._prelimContent.splice(t,0,...n)}insertAfter(t,n){if(this.doc!==null)A(this.doc,r=>{let s=t&&t instanceof L?t._item:t;br(r,this,s,n)});else{let r=this._prelimContent,s=t===null?0:r.findIndex(i=>i===t)+1;if(s===0&&t!==null)throw Pt("Reference item not found");r.splice(s,0,...n)}}delete(t,n=1){this.doc!==null?A(this.doc,r=>{nl(r,this,t,n)}):this._prelimContent.splice(t,n)}toArray(){return Zc(this)}push(t){this.insert(this.length,t)}unshift(t){this.insert(0,t)}get(t){return Qc(this,t)}slice(t=0,n=this.length){return Xc(this,t,n)}forEach(t){bn(this,t)}_write(t){t.writeTypeRef(cf)}},Pd=e=>new Ut,Yt=class extends Ut{constructor(t="UNDEFINED"){super(),this.nodeName=t,this._prelimAttrs=new Map}get nextSibling(){let t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){let t=this._item?this._item.prev:null;return t?t.content.type:null}_integrate(t,n){super._integrate(t,n),this._prelimAttrs.forEach((r,s)=>{this.setAttribute(s,r)}),this._prelimAttrs=null}_copy(){return new Yt(this.nodeName)}clone(){let t=new Yt(this.nodeName),n=this.getAttributes();for(let r in n)t.setAttribute(r,n[r]);return t.insert(0,this.toArray().map(r=>r instanceof L?r.clone():r)),t}toString(){let t=this.getAttributes(),n=[],r=[];for(let c in t)r.push(c);r.sort();let s=r.length;for(let c=0;c<s;c++){let l=r[c];n.push(l+'="'+t[l]+'"')}let i=this.nodeName.toLocaleLowerCase(),o=n.length>0?" "+n.join(" "):"";return`<${i}${o}>${super.toString()}</${i}>`}removeAttribute(t){this.doc!==null?A(this.doc,n=>{Br(n,this,t)}):this._prelimAttrs.delete(t)}setAttribute(t,n){this.doc!==null?A(this.doc,r=>{li(r,this,t,n)}):this._prelimAttrs.set(t,n)}getAttribute(t){return ai(this,t)}hasAttribute(t){return sl(this,t)}getAttributes(){return rl(this)}toDOM(t=document,n={},r){let s=t.createElement(this.nodeName),i=this.getAttributes();for(let o in i)s.setAttribute(o,i[o]);return bn(this,o=>{s.appendChild(o.toDOM(t,n,r))}),r!==void 0&&r._createAssociation(s,this),s}_write(t){t.writeTypeRef(of),t.writeKey(this.nodeName)}},zd=e=>new Yt(e.readKey()),kr=class extends ye{constructor(t,n,r){super(t,r),this.childListChanged=!1,this.attributesChanged=new Set,n.forEach(s=>{s===null?this.childListChanged=!0:this.attributesChanged.add(s)})}},Ie=class extends Bt{constructor(t){super(),this.hookName=t}_copy(){return new Ie(this.hookName)}clone(){let t=new Ie(this.hookName);return this.forEach((n,r)=>{t.set(r,n)}),t}toDOM(t=document,n={},r){let s=n[this.hookName],i;return s!==void 0?i=s.createDom(this):i=document.createElement(this.hookName),i.setAttribute("data-yjs-hook",this.hookName),r!==void 0&&r._createAssociation(i,this),i}_write(t){t.writeTypeRef(lf),t.writeKey(this.hookName)}},Gd=e=>new Ie(e.readKey()),Se=class extends Mt{get nextSibling(){let t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){let t=this._item?this._item.prev:null;return t?t.content.type:null}_copy(){return new Se}clone(){let t=new Se;return t.applyDelta(this.toDelta()),t}toDOM(t=document,n,r){let s=t.createTextNode(this.toString());return r!==void 0&&r._createAssociation(s,this),s}toString(){return this.toDelta().map(t=>{let n=[];for(let s in t.attributes){let i=[];for(let o in t.attributes[s])i.push({key:o,value:t.attributes[s][o]});i.sort((o,c)=>o.key<c.key?-1:1),n.push({nodeName:s,attrs:i})}n.sort((s,i)=>s.nodeName<i.nodeName?-1:1);let r="";for(let s=0;s<n.length;s++){let i=n[s];r+=`<${i.nodeName}`;for(let o=0;o<i.attrs.length;o++){let c=i.attrs[o];r+=` ${c.key}="${c.value}"`}r+=">"}r+=t.insert;for(let s=n.length-1;s>=0;s--)r+=`</${n[s].nodeName}>`;return r}).join("")}toJSON(){return this.toString()}_write(t){t.writeTypeRef(af)}},$d=e=>new Se,qe=class{constructor(t,n){this.id=t,this.length=n}get deleted(){throw ut()}mergeWith(t){return!1}write(t,n,r){throw ut()}integrate(t,n){throw ut()}},Jd=0,$=class extends qe{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,n){n>0&&(this.id.clock+=n,this.length-=n),Nc(t.doc.store,this)}write(t,n){t.writeInfo(Jd),t.writeLen(this.length-n)}getMissing(t,n){return null}},Qt=class{constructor(t){this.content=t}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new Qt(this.content)}splice(t){throw ut()}mergeWith(t){return!1}integrate(t,n){}delete(t){}gc(t){}write(t,n){t.writeBuf(this.content)}getRef(){return 3}},Hd=e=>new Qt(e.readBuf()),te=class{constructor(t){this.len=t}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new te(this.len)}splice(t){let n=new te(this.len-t);return this.len=t,n}mergeWith(t){return this.len+=t.len,!0}integrate(t,n){mn(t.deleteSet,n.id.client,n.id.clock,this.len),n.markDeleted()}delete(t){}gc(t){}write(t,n){t.writeLen(this.len-n)}getRef(){return 1}},Kd=e=>new te(e.readLen()),hl=(e,t)=>new Ot({guid:e,...t,shouldLoad:t.shouldLoad||t.autoLoad||!1}),Te=class{constructor(t){t._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=t;let n={};this.opts=n,t.gc||(n.gc=!1),t.autoLoad&&(n.autoLoad=!0),t.meta!==null&&(n.meta=t.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new Te(hl(this.doc.guid,this.opts))}splice(t){throw ut()}mergeWith(t){return!1}integrate(t,n){this.doc._item=n,t.subdocsAdded.add(this.doc),this.doc.shouldLoad&&t.subdocsLoaded.add(this.doc)}delete(t){t.subdocsAdded.has(this.doc)?t.subdocsAdded.delete(this.doc):t.subdocsRemoved.add(this.doc)}gc(t){}write(t,n){t.writeString(this.doc.guid),t.writeAny(this.opts)}getRef(){return 9}},Wd=e=>new Te(hl(e.readString(),e.readAny())),_t=class{constructor(t){this.embed=t}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new _t(this.embed)}splice(t){throw ut()}mergeWith(t){return!1}integrate(t,n){}delete(t){}gc(t){}write(t,n){t.writeJSON(this.embed)}getRef(){return 5}},Xd=e=>new _t(e.readJSON()),O=class{constructor(t,n){this.key=t,this.value=n}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new O(this.key,this.value)}splice(t){throw ut()}mergeWith(t){return!1}integrate(t,n){n.parent._searchMarker=null}delete(t){}gc(t){}write(t,n){t.writeKey(this.key),t.writeJSON(this.value)}getRef(){return 6}},Zd=e=>new O(e.readKey(),e.readJSON()),be=class{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new be(this.arr)}splice(t){let n=new be(this.arr.slice(t));return this.arr=this.arr.slice(0,t),n}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,n){}delete(t){}gc(t){}write(t,n){let r=this.arr.length;t.writeLen(r-n);for(let s=n;s<r;s++){let i=this.arr[s];t.writeString(i===void 0?"undefined":JSON.stringify(i))}}getRef(){return 2}},Yd=e=>{let t=e.readLen(),n=[];for(let r=0;r<t;r++){let s=e.readString();s==="undefined"?n.push(void 0):n.push(JSON.parse(s))}return new be(n)},xt=class{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new xt(this.arr)}splice(t){let n=new xt(this.arr.slice(t));return this.arr=this.arr.slice(0,t),n}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,n){}delete(t){}gc(t){}write(t,n){let r=this.arr.length;t.writeLen(r-n);for(let s=n;s<r;s++){let i=this.arr[s];t.writeAny(i)}}getRef(){return 8}},Qd=e=>{let t=e.readLen(),n=[];for(let r=0;r<t;r++)n.push(e.readAny());return new xt(n)},Y=class{constructor(t){this.str=t}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new Y(this.str)}splice(t){let n=new Y(this.str.slice(t));this.str=this.str.slice(0,t);let r=this.str.charCodeAt(t-1);return r>=55296&&r<=56319&&(this.str=this.str.slice(0,t-1)+"\uFFFD",n.str="\uFFFD"+n.str.slice(1)),n}mergeWith(t){return this.str+=t.str,!0}integrate(t,n){}delete(t){}gc(t){}write(t,n){t.writeString(n===0?this.str:this.str.slice(n))}getRef(){return 4}},tf=e=>new Y(e.readString()),ef=[Rd,Fd,jd,zd,Pd,Gd,$d],nf=0,rf=1,sf=2,of=3,cf=4,lf=5,af=6,Q=class{constructor(t){this.type=t}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new Q(this.type._copy())}splice(t){throw ut()}mergeWith(t){return!1}integrate(t,n){this.type._integrate(t.doc,n)}delete(t){let n=this.type._start;for(;n!==null;)n.deleted?t._mergeStructs.push(n):n.delete(t),n=n.right;this.type._map.forEach(r=>{r.deleted?t._mergeStructs.push(r):r.delete(t)}),t.changed.delete(this.type)}gc(t){let n=this.type._start;for(;n!==null;)n.gc(t,!0),n=n.right;this.type._start=null,this.type._map.forEach(r=>{for(;r!==null;)r.gc(t,!0),r=r.left}),this.type._map=new Map}write(t,n){this.type._write(t)}getRef(){return 7}},hf=e=>new Q(ef[e.readTypeRef()](e)),Ws=(e,t)=>{let n=t,r=0,s;do r>0&&(n=y(n.client,n.clock+r)),s=dn(e,n),r=n.clock-s.id.clock,n=s.redone;while(n!==null&&s instanceof x);return{item:s,diff:r}},hi=(e,t)=>{for(;e!==null&&e.keep!==t;)e.keep=t,e=e.parent._item},Ar=(e,t,n)=>{let{client:r,clock:s}=t.id,i=new x(y(r,s+n),t,y(r,s+n-1),t.right,t.rightOrigin,t.parent,t.parentSub,t.content.splice(n));return t.deleted&&i.markDeleted(),t.keep&&(i.keep=!0),t.redone!==null&&(i.redone=y(t.redone.client,t.redone.clock+n)),t.right=i,i.right!==null&&(i.right.left=i),e._mergeStructs.push(i),i.parentSub!==null&&i.right===null&&i.parent._map.set(i.parentSub,i),t.length=n,i},ul=(e,t,n,r,s)=>{let i=e.doc,o=i.store,c=i.clientID,l=t.redone;if(l!==null)return G(e,l);let h=t.parent._item,a=null,u;if(h!==null&&h.deleted===!0){if(h.redone===null&&(!n.has(h)||ul(e,h,n,r,s)===null))return null;for(;h.redone!==null;)h=G(e,h.redone)}let f=h===null?t.parent:h.content.type;if(t.parentSub===null){for(a=t.left,u=t;a!==null;){let S=a;for(;S!==null&&S.parent._item!==h;)S=S.redone===null?null:G(e,S.redone);if(S!==null&&S.parent._item===h){a=S;break}a=a.left}for(;u!==null;){let S=u;for(;S!==null&&S.parent._item!==h;)S=S.redone===null?null:G(e,S.redone);if(S!==null&&S.parent._item===h){u=S;break}u=u.right}}else if(u=null,t.right&&!s){for(a=t;a!==null&&a.right!==null&&je(r,a.right.id);)a=a.right;for(;a!==null&&a.redone!==null;)a=G(e,a.redone);if(a&&a.right!==null)return null}else a=f._map.get(t.parentSub)||null;let d=v(o,c),g=y(c,d),I=new x(g,a,a&&a.lastId,u,u&&u.id,f,t.parentSub,t.content.copy());return t.redone=g,hi(I,!0),I.integrate(e,0),I},x=class extends qe{constructor(t,n,r,s,i,o,c,l){super(t,l.getLength()),this.origin=r,this.left=n,this.right=s,this.rightOrigin=i,this.parent=o,this.parentSub=c,this.redone=null,this.content=l,this.info=this.content.isCountable()?2:0}set marker(t){(this.info&8)>0!==t&&(this.info^=8)}get marker(){return(this.info&8)>0}get keep(){return(this.info&1)>0}set keep(t){this.keep!==t&&(this.info^=1)}get countable(){return(this.info&2)>0}get deleted(){return(this.info&4)>0}set deleted(t){this.deleted!==t&&(this.info^=4)}markDeleted(){this.info|=4}getMissing(t,n){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=v(n,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=v(n,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===Vt&&this.id.client!==this.parent.client&&this.parent.clock>=v(n,this.parent.client))return this.parent.client;if(this.origin&&(this.left=Tc(t,n,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=G(t,this.rightOrigin),this.rightOrigin=this.right.id),(this.left&&this.left.constructor===$||this.right&&this.right.constructor===$)&&(this.parent=null),!this.parent)this.left&&this.left.constructor===x&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===x&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===Vt){let r=dn(n,this.parent);r.constructor===$?this.parent=null:this.parent=r.content.type}return null}integrate(t,n){if(n>0&&(this.id.clock+=n,this.left=Tc(t,t.doc.store,y(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(n),this.length-=n),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let r=this.left,s;if(r!==null)s=r.right;else if(this.parentSub!==null)for(s=this.parent._map.get(this.parentSub)||null;s!==null&&s.left!==null;)s=s.left;else s=this.parent._start;let i=new Set,o=new Set;for(;s!==null&&s!==this.right;){if(o.add(s),i.add(s),me(this.origin,s.origin)){if(s.id.client<this.id.client)r=s,i.clear();else if(me(this.rightOrigin,s.rightOrigin))break}else if(s.origin!==null&&o.has(dn(t.doc.store,s.origin)))i.has(dn(t.doc.store,s.origin))||(r=s,i.clear());else break;s=s.right}this.left=r}if(this.left!==null){let r=this.left.right;this.right=r,this.left.right=this}else{let r;if(this.parentSub!==null)for(r=this.parent._map.get(this.parentSub)||null;r!==null&&r.left!==null;)r=r.left;else r=this.parent._start,this.parent._start=this;this.right=r}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(t)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),Nc(t.doc.store,this),this.content.integrate(t,this),Bc(t,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(t)}else new $(this.id,this.length).integrate(t,0)}get next(){let t=this.right;for(;t!==null&&t.deleted;)t=t.right;return t}get prev(){let t=this.left;for(;t!==null&&t.deleted;)t=t.left;return t}get lastId(){return this.length===1?this.id:y(this.id.client,this.id.clock+this.length-1)}mergeWith(t){if(this.constructor===t.constructor&&me(t.origin,this.lastId)&&this.right===t&&me(this.rightOrigin,t.rightOrigin)&&this.id.client===t.id.client&&this.id.clock+this.length===t.id.clock&&this.deleted===t.deleted&&this.redone===null&&t.redone===null&&this.content.constructor===t.content.constructor&&this.content.mergeWith(t.content)){let n=this.parent._searchMarker;return n&&n.forEach(r=>{r.p===t&&(r.p=this,!this.deleted&&this.countable&&(r.index-=this.length))}),t.keep&&(this.keep=!0),this.right=t.right,this.right!==null&&(this.right.left=this),this.length+=t.length,!0}return!1}delete(t){if(!this.deleted){let n=this.parent;this.countable&&this.parentSub===null&&(n._length-=this.length),this.markDeleted(),mn(t.deleteSet,this.id.client,this.id.clock,this.length),Bc(t,n,this.parentSub),this.content.delete(t)}}gc(t,n){if(!this.deleted)throw X();this.content.gc(t),n?Sd(t,this,new $(this.id,this.length)):this.content=new te(this.length)}write(t,n){let r=n>0?y(this.id.client,this.id.clock+n-1):this.origin,s=this.rightOrigin,i=this.parentSub,o=this.content.getRef()&31|(r===null?0:128)|(s===null?0:64)|(i===null?0:32);if(t.writeInfo(o),r!==null&&t.writeLeftID(r),s!==null&&t.writeRightID(s),r===null&&s===null){let c=this.parent;if(c._item!==void 0){let l=c._item;if(l===null){let h=ri(c);t.writeParentInfo(!0),t.writeString(h)}else t.writeParentInfo(!1),t.writeLeftID(l.id)}else c.constructor===String?(t.writeParentInfo(!0),t.writeString(c)):c.constructor===Vt?(t.writeParentInfo(!1),t.writeLeftID(c)):X();i!==null&&t.writeString(i)}this.content.write(t,n)}},dl=(e,t)=>uf[t&31](e),uf=[()=>{X()},Kd,Yd,Hd,tf,Xd,Zd,hf,Qd,Wd,()=>{X()}],df=10,J=class extends qe{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,n){X()}write(t,n){t.writeInfo(df),w(t.restEncoder,this.length-n)}getMissing(t,n){return null}},fl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},gl="__ $YJS$ __";fl[gl]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438");fl[gl]=!0});var _n=E(N=>{"use strict";var pl=String.fromCharCode,ml=String.fromCodePoint,ff=e=>e.toLowerCase(),gf=/^\s*/g,ui=e=>e.replace(gf,""),pf=/([A-Z])/g,wl=(e,t)=>ui(e.replace(pf,n=>`${t}${ff(n)}`)),yl=e=>unescape(encodeURIComponent(e)).length,di=e=>{let t=unescape(encodeURIComponent(e)),n=t.length,r=new Uint8Array(n);for(let s=0;s<n;s++)r[s]=t.codePointAt(s);return r},Nr=typeof TextEncoder<"u"?new TextEncoder:null,fi=e=>Nr.encode(e),Il=Nr?fi:di,gi=e=>{let t=e.length,n="",r=0;for(;t>0;){let s=t<1e4?t:1e4,i=e.subarray(r,r+s);r+=s,n+=String.fromCodePoint.apply(null,i),t-=s}return decodeURIComponent(escape(n))};N.utf8TextDecoder=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});N.utf8TextDecoder&&N.utf8TextDecoder.decode(new Uint8Array).length===1&&(N.utf8TextDecoder=null);var pi=e=>N.utf8TextDecoder.decode(e),Sl=N.utf8TextDecoder?pi:gi,Tl=(e,t,n,r="")=>e.slice(0,t)+r+e.slice(t+n),mf=Object.freeze({__proto__:null,fromCharCode:pl,fromCodePoint:ml,trimLeft:ui,fromCamelCase:wl,utf8ByteLength:yl,_encodeUtf8Polyfill:di,utf8TextEncoder:Nr,_encodeUtf8Native:fi,encodeUtf8:Il,_decodeUtf8Polyfill:gi,get utf8TextDecoder(){return N.utf8TextDecoder},_decodeUtf8Native:pi,decodeUtf8:Sl,splice:Tl});N._decodeUtf8Native=pi;N._decodeUtf8Polyfill=gi;N._encodeUtf8Native=fi;N._encodeUtf8Polyfill=di;N.decodeUtf8=Sl;N.encodeUtf8=Il;N.fromCamelCase=wl;N.fromCharCode=pl;N.fromCodePoint=ml;N.splice=Tl;N.string=mf;N.trimLeft=ui;N.utf8ByteLength=yl;N.utf8TextEncoder=Nr});var ze=E(ee=>{"use strict";var mi=()=>new Map,bl=e=>{let t=mi();return e.forEach((n,r)=>{t.set(r,n)}),t},Bl=(e,t,n)=>{let r=e.get(t);return r===void 0&&e.set(t,r=n()),r},Ul=(e,t)=>{let n=[];for(let[r,s]of e)n.push(t(s,r));return n},_l=(e,t)=>{for(let[n,r]of e)if(t(r,n))return!0;return!1},xl=(e,t)=>{for(let[n,r]of e)if(!t(r,n))return!1;return!0},wf=Object.freeze({__proto__:null,create:mi,copy:bl,setIfUndefined:Bl,map:Ul,any:_l,all:xl});ee.all=xl;ee.any=_l;ee.copy=bl;ee.create=mi;ee.map=Ul;ee.map$1=wf;ee.setIfUndefined=Bl});var Lr=E(wi=>{"use strict";var kl=e=>e===void 0?null:e,yf=Object.freeze({__proto__:null,undefinedToNull:kl});wi.conditions=yf;wi.undefinedToNull=kl});var Rr=E(Mr=>{"use strict";Object.defineProperty(Mr,"__esModule",{value:!0});var yi=class{constructor(){this.map=new Map}setItem(t,n){this.map.set(t,n)}getItem(t){return this.map.get(t)}},Al=new yi,El=!0;try{typeof localStorage<"u"&&(Al=localStorage,El=!1)}catch{}var If=Al,Sf=e=>El||addEventListener("storage",e);Mr.onChange=Sf;Mr.varStorage=If});var Ge=E(st=>{"use strict";var Cl=e=>e[e.length-1],Dl=()=>[],vl=e=>e.slice(),Vl=(e,t)=>{for(let n=0;n<t.length;n++)e.push(t[n])},Ol=Array.from,Ii=(e,t)=>e.every(t),Nl=(e,t)=>e.some(t),Ll=(e,t)=>e.length===t.length&&Ii(e,(n,r)=>n===t[r]),Ml=e=>e.reduce((t,n)=>t.concat(n),[]),Rl=Array.isArray,Tf=Object.freeze({__proto__:null,last:Cl,create:Dl,copy:vl,appendTo:Vl,from:Ol,every:Ii,some:Nl,equalFlat:Ll,flatten:Ml,isArray:Rl});st.appendTo=Vl;st.array=Tf;st.copy=vl;st.create=Dl;st.equalFlat=Ll;st.every=Ii;st.flatten=Ml;st.from=Ol;st.isArray=Rl;st.last=Cl;st.some=Nl});var xn=E(it=>{"use strict";var Fl=()=>Object.create(null),ql=Object.assign,Si=Object.keys,jl=(e,t)=>{for(let n in e)t(e[n],n)},Pl=(e,t)=>{let n=[];for(let r in e)n.push(t(e[r],r));return n},Fr=e=>Si(e).length,zl=(e,t)=>{for(let n in e)if(t(e[n],n))return!0;return!1},Ti=(e,t)=>{for(let n in e)if(!t(e[n],n))return!1;return!0},bi=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),Gl=(e,t)=>e===t||Fr(e)===Fr(t)&&Ti(e,(n,r)=>(n!==void 0||bi(t,r))&&t[r]===n),bf=Object.freeze({__proto__:null,create:Fl,assign:ql,keys:Si,forEach:jl,map:Pl,length:Fr,some:zl,every:Ti,hasProperty:bi,equalFlat:Gl});it.assign=ql;it.create=Fl;it.equalFlat=Gl;it.every=Ti;it.forEach=jl;it.hasProperty=bi;it.keys=Si;it.length=Fr;it.map=Pl;it.object=bf;it.some=zl});var An=E(kt=>{"use strict";var Bf=Ge(),qr=xn(),Bi=(e,t,n=0)=>{try{for(;n<e.length;n++)e[n](...t)}finally{n<e.length&&Bi(e,t,n+1)}},$l=()=>{},Jl=e=>e(),Hl=e=>e,Ui=(e,t)=>e===t,Kl=(e,t)=>e===t||e!=null&&t!=null&&e.constructor===t.constructor&&(e instanceof Array&&Bf.equalFlat(e,t)||typeof e=="object"&&qr.equalFlat(e,t)),kn=(e,t)=>{if(e==null||t==null)return Ui(e,t);if(e.constructor!==t.constructor)return!1;if(e===t)return!0;switch(e.constructor){case ArrayBuffer:e=new Uint8Array(e),t=new Uint8Array(t);case Uint8Array:{if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;break}case Set:{if(e.size!==t.size)return!1;for(let n of e)if(!t.has(n))return!1;break}case Map:{if(e.size!==t.size)return!1;for(let n of e.keys())if(!t.has(n)||!kn(e.get(n),t.get(n)))return!1;break}case Object:if(qr.length(e)!==qr.length(t))return!1;for(let n in e)if(!qr.hasProperty(e,n)||!kn(e[n],t[n]))return!1;break;case Array:if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!kn(e[n],t[n]))return!1;break;default:return!1}return!0},Wl=(e,t)=>t.includes(e),Uf=Object.freeze({__proto__:null,callAll:Bi,nop:$l,apply:Jl,id:Hl,equalityStrict:Ui,equalityFlat:Kl,equalityDeep:kn,isOneOf:Wl});kt._function=Uf;kt.apply=Jl;kt.callAll=Bi;kt.equalityDeep=kn;kt.equalityFlat=Kl;kt.equalityStrict=Ui;kt.id=Hl;kt.isOneOf=Wl;kt.nop=$l});var jr=E(ot=>{"use strict";var _i=ze(),Xl=_n(),Zl=Lr(),_f=Rr(),xf=An(),ne=typeof process<"u"&&process.release&&/node|io\.js/.test(process.release.name),Ql=typeof window<"u"&&!ne,ta=typeof navigator<"u"?/Mac/.test(navigator.platform):!1,At,xi=()=>{if(At===void 0)if(ne){At=_i.create();let e=process.argv,t=null;for(let n=0;n<e.length;n++){let r=e[n];r[0]==="-"?(t!==null&&At.set(t,""),t=r):t!==null&&(At.set(t,r),t=null)}t!==null&&At.set(t,"")}else typeof location=="object"?(At=_i.create(),(location.search||"?").slice(1).split("&").forEach(e=>{if(e.length!==0){let[t,n]=e.split("=");At.set(`--${Xl.fromCamelCase(t,"-")}`,n),At.set(`-${Xl.fromCamelCase(t,"-")}`,n)}})):At=_i.create();return At},En=e=>xi().has(e),ea=(e,t)=>xi().get(e)||t,$e=e=>ne?Zl.undefinedToNull(process.env[e.toUpperCase()]):Zl.undefinedToNull(_f.varStorage.getItem(e)),na=e=>xi().get("--"+e)||$e(e),ki=e=>En("--"+e)||$e(e)!==null,ra=ki("production"),Yl=ne&&xf.isOneOf(process.env.FORCE_COLOR,["true","1","2"]),sa=!En("no-colors")&&(!ne||process.stdout.isTTY||Yl)&&(!ne||En("color")||Yl||$e("COLORTERM")!==null||($e("TERM")||"").includes("color")),kf=Object.freeze({__proto__:null,isNode:ne,isBrowser:Ql,isMac:ta,hasParam:En,getParam:ea,getVariable:$e,getConf:na,hasConf:ki,production:ra,supportsColor:sa});ot.environment=kf;ot.getConf=na;ot.getParam=ea;ot.getVariable=$e;ot.hasConf=ki;ot.hasParam=En;ot.isBrowser=Ql;ot.isMac=ta;ot.isNode=ne;ot.production=ra;ot.supportsColor=sa});var Cn=E(m=>{"use strict";var Af=Object.freeze({__proto__:null,BIT1:1,BIT2:2,BIT3:4,BIT4:8,BIT5:16,BIT6:32,BIT7:64,BIT8:128,BIT9:256,BIT10:512,BIT11:1024,BIT12:2048,BIT13:4096,BIT14:8192,BIT15:16384,BIT16:32768,BIT17:65536,BIT18:131072,BIT19:262144,BIT20:524288,BIT21:1048576,BIT22:2097152,BIT23:4194304,BIT24:8388608,BIT25:16777216,BIT26:33554432,BIT27:67108864,BIT28:134217728,BIT29:268435456,BIT30:536870912,BIT31:1073741824,BIT32:-2147483648,BITS0:0,BITS1:1,BITS2:3,BITS3:7,BITS4:15,BITS5:31,BITS6:63,BITS7:127,BITS8:255,BITS9:511,BITS10:1023,BITS11:2047,BITS12:4095,BITS13:8191,BITS14:16383,BITS15:32767,BITS16:65535,BITS17:131071,BITS18:262143,BITS19:524287,BITS20:1048575,BITS21:2097151,BITS22:4194303,BITS23:8388607,BITS24:16777215,BITS25:33554431,BITS26:67108863,BITS27:134217727,BITS28:268435455,BITS29:536870911,BITS30:1073741823,BITS31:2147483647,BITS32:4294967295});m.BIT1=1;m.BIT10=512;m.BIT11=1024;m.BIT12=2048;m.BIT13=4096;m.BIT14=8192;m.BIT15=16384;m.BIT16=32768;m.BIT17=65536;m.BIT18=131072;m.BIT19=262144;m.BIT2=2;m.BIT20=524288;m.BIT21=1048576;m.BIT22=2097152;m.BIT23=4194304;m.BIT24=8388608;m.BIT25=16777216;m.BIT26=33554432;m.BIT27=67108864;m.BIT28=134217728;m.BIT29=268435456;m.BIT3=4;m.BIT30=536870912;m.BIT31=1073741824;m.BIT32=-2147483648;m.BIT4=8;m.BIT5=16;m.BIT6=32;m.BIT7=64;m.BIT8=128;m.BIT9=256;m.BITS0=0;m.BITS1=1;m.BITS10=1023;m.BITS11=2047;m.BITS12=4095;m.BITS13=8191;m.BITS14=16383;m.BITS15=32767;m.BITS16=65535;m.BITS17=131071;m.BITS18=262143;m.BITS19=524287;m.BITS2=3;m.BITS20=1048575;m.BITS21=2097151;m.BITS22=4194303;m.BITS23=8388607;m.BITS24=16777215;m.BITS25=33554431;m.BITS26=67108863;m.BITS27=134217727;m.BITS28=268435455;m.BITS29=536870911;m.BITS3=7;m.BITS30=1073741823;m.BITS31=2147483647;m.BITS32=4294967295;m.BITS4=15;m.BITS5=31;m.BITS6=63;m.BITS7=127;m.BITS8=255;m.BITS9=511;m.binary=Af});var Rt=E(R=>{"use strict";var ia=Math.floor,oa=Math.ceil,ca=Math.abs,la=Math.imul,aa=Math.round,ha=Math.log10,ua=Math.log2,da=Math.log,fa=Math.sqrt,ga=(e,t)=>e+t,pa=(e,t)=>e<t?e:t,ma=(e,t)=>e>t?e:t,wa=Number.isNaN,ya=Math.pow,Ia=e=>Math.pow(10,e),Sa=Math.sign,Ta=e=>e!==0?e<0:1/e<0,Ef=Object.freeze({__proto__:null,floor:ia,ceil:oa,abs:ca,imul:la,round:aa,log10:ha,log2:ua,log:da,sqrt:fa,add:ga,min:pa,max:ma,isNaN:wa,pow:ya,exp10:Ia,sign:Sa,isNegativeZero:Ta});R.abs=ca;R.add=ga;R.ceil=oa;R.exp10=Ia;R.floor=ia;R.imul=la;R.isNaN=wa;R.isNegativeZero=Ta;R.log=da;R.log10=ha;R.log2=ua;R.math=Ef;R.max=ma;R.min=pa;R.pow=ya;R.round=aa;R.sign=Sa;R.sqrt=fa});var Pr=E(Ft=>{"use strict";var Cf=Rt(),Df=Cn(),ba=Number.MAX_SAFE_INTEGER,Ba=Number.MIN_SAFE_INTEGER,Ua=1<<31,_a=Df.BITS31,xa=Number.isInteger||(e=>typeof e=="number"&&isFinite(e)&&Cf.floor(e)===e),ka=Number.isNaN,Aa=Number.parseInt,vf=Object.freeze({__proto__:null,MAX_SAFE_INTEGER:ba,MIN_SAFE_INTEGER:Ba,LOWEST_INT32:Ua,HIGHEST_INT32:_a,isInteger:xa,isNaN:ka,parseInt:Aa});Ft.HIGHEST_INT32=_a;Ft.LOWEST_INT32=Ua;Ft.MAX_SAFE_INTEGER=ba;Ft.MIN_SAFE_INTEGER=Ba;Ft.isInteger=xa;Ft.isNaN=ka;Ft.number=vf;Ft.parseInt=Aa});var Gr=E(Dn=>{"use strict";var zr=e=>new Error(e),Ea=()=>{throw zr("Method unimplemented")},Ca=()=>{throw zr("Unexpected case")},Vf=Object.freeze({__proto__:null,create:zr,methodUnimplemented:Ea,unexpectedCase:Ca});Dn.create=zr;Dn.error=Vf;Dn.methodUnimplemented=Ea;Dn.unexpectedCase=Ca});var zi=E(p=>{"use strict";var Be=_n(),Va=jr(),C=Cn(),pt=Rt(),Ei=Pr(),Oa=Gr(),ct=class{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}},Ci=()=>new ct,Di=e=>{let t=e.cpos;for(let n=0;n<e.bufs.length;n++)t+=e.bufs[n].length;return t},re=e=>{let t=new Uint8Array(Di(e)),n=0;for(let r=0;r<e.bufs.length;r++){let s=e.bufs[r];t.set(s,n),n+=s.length}return t.set(Fn(e.cbuf.buffer,0,e.cpos),n),t},vi=(e,t)=>{let n=e.cbuf.length;n-e.cpos<t&&(e.bufs.push(Fn(e.cbuf.buffer,0,e.cpos)),e.cbuf=new Uint8Array(pt.max(n,t)*2),e.cpos=0)},D=(e,t)=>{let n=e.cbuf.length;e.cpos===n&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(n*2),e.cpos=0),e.cbuf[e.cpos++]=t},Je=(e,t,n)=>{let r=null;for(let s=0;s<e.bufs.length&&r===null;s++){let i=e.bufs[s];t<i.length?r=i:t-=i.length}r===null&&(r=e.cbuf),r[t]=n},Na=D,La=Je,Ma=(e,t)=>{D(e,t&C.BITS8),D(e,t>>>8&C.BITS8)},Ra=(e,t,n)=>{Je(e,t,n&C.BITS8),Je(e,t+1,n>>>8&C.BITS8)},Fa=(e,t)=>{for(let n=0;n<4;n++)D(e,t&C.BITS8),t>>>=8},qa=(e,t)=>{for(let n=3;n>=0;n--)D(e,t>>>8*n&C.BITS8)},ja=(e,t,n)=>{for(let r=0;r<4;r++)Je(e,t+r,n&C.BITS8),n>>>=8},mt=(e,t)=>{for(;t>C.BITS7;)D(e,C.BIT8|C.BITS7&t),t=pt.floor(t/128);D(e,C.BITS7&t)},Ue=(e,t)=>{let n=pt.isNegativeZero(t);for(n&&(t=-t),D(e,(t>C.BITS6?C.BIT8:0)|(n?C.BIT7:0)|C.BITS6&t),t=pt.floor(t/64);t>0;)D(e,(t>C.BITS7?C.BIT8:0)|C.BITS7&t),t=pt.floor(t/128)},Ai=new Uint8Array(3e4),Of=Ai.length/3,Vi=(e,t)=>{if(t.length<Of){let n=Be.utf8TextEncoder.encodeInto(t,Ai).written||0;mt(e,n);for(let r=0;r<n;r++)D(e,Ai[r])}else ss(e,Be.encodeUtf8(t))},Oi=(e,t)=>{let n=unescape(encodeURIComponent(t)),r=n.length;mt(e,r);for(let s=0;s<r;s++)D(e,n.codePointAt(s))},vn=Be.utf8TextEncoder&&Be.utf8TextEncoder.encodeInto?Vi:Oi,Pa=(e,t)=>Rn(e,re(t)),Rn=(e,t)=>{let n=e.cbuf.length,r=e.cpos,s=pt.min(n-r,t.length),i=t.length-s;e.cbuf.set(t.subarray(0,s),r),e.cpos+=s,i>0&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(pt.max(n*2,i)),e.cbuf.set(t.subarray(s)),e.cpos=i)},ss=(e,t)=>{mt(e,t.byteLength),Rn(e,t)},Ke=(e,t)=>{vi(e,t);let n=new DataView(e.cbuf.buffer,e.cpos,t);return e.cpos+=t,n},Ni=(e,t)=>Ke(e,4).setFloat32(0,t,!1),Li=(e,t)=>Ke(e,8).setFloat64(0,t,!1),Mi=(e,t)=>Ke(e,8).setBigInt64(0,t,!1),za=(e,t)=>Ke(e,8).setBigUint64(0,t,!1),Da=new DataView(new ArrayBuffer(4)),Nf=e=>(Da.setFloat32(0,e),Da.getFloat32(0)===e),Vn=(e,t)=>{switch(typeof t){case"string":D(e,119),vn(e,t);break;case"number":Ei.isInteger(t)&&pt.abs(t)<=C.BITS31?(D(e,125),Ue(e,t)):Nf(t)?(D(e,124),Ni(e,t)):(D(e,123),Li(e,t));break;case"bigint":D(e,122),Mi(e,t);break;case"object":if(t===null)D(e,126);else if(t instanceof Array){D(e,117),mt(e,t.length);for(let n=0;n<t.length;n++)Vn(e,t[n])}else if(t instanceof Uint8Array)D(e,116),ss(e,t);else{D(e,118);let n=Object.keys(t);mt(e,n.length);for(let r=0;r<n.length;r++){let s=n[r];vn(e,s),Vn(e,t[s])}}break;case"boolean":D(e,t?120:121);break;default:D(e,127)}},$r=class extends ct{constructor(t){super(),this.w=t,this.s=null,this.count=0}write(t){this.s===t?this.count++:(this.count>0&&mt(this,this.count-1),this.count=1,this.w(this,t),this.s=t)}},Jr=class extends ct{constructor(t){super(),this.s=t}write(t){Ue(this,t-this.s),this.s=t}},Hr=class extends ct{constructor(t){super(),this.s=t,this.count=0}write(t){this.s===t&&this.count>0?this.count++:(this.count>0&&mt(this,this.count-1),this.count=1,Ue(this,t-this.s),this.s=t)}},Kr=e=>{e.count>0&&(Ue(e.encoder,e.count===1?e.s:-e.s),e.count>1&&mt(e.encoder,e.count-2))},On=class{constructor(){this.encoder=new ct,this.s=0,this.count=0}write(t){this.s===t?this.count++:(Kr(this),this.count=1,this.s=t)}toUint8Array(){return Kr(this),re(this.encoder)}},Wr=class{constructor(){this.encoder=new ct,this.s=0,this.count=0}write(t){this.s+this.count===t?this.count++:(Kr(this),this.count=1,this.s=t)}toUint8Array(){return Kr(this),re(this.encoder)}},va=e=>{if(e.count>0){let t=e.diff*2+(e.count===1?0:1);Ue(e.encoder,t),e.count>1&&mt(e.encoder,e.count-2)}},Xr=class{constructor(){this.encoder=new ct,this.s=0,this.count=0,this.diff=0}write(t){this.diff===t-this.s?(this.s=t,this.count++):(va(this),this.count=1,this.diff=t-this.s,this.s=t)}toUint8Array(){return va(this),re(this.encoder)}},Zr=class{constructor(){this.sarr=[],this.s="",this.lensE=new On}write(t){this.s+=t,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(t.length)}toUint8Array(){let t=new ct;return this.sarr.push(this.s),this.s="",vn(t,this.sarr.join("")),Rn(t,this.lensE.toUint8Array()),re(t)}},Lf=Object.freeze({__proto__:null,Encoder:ct,createEncoder:Ci,length:Di,toUint8Array:re,verifyLen:vi,write:D,set:Je,writeUint8:Na,setUint8:La,writeUint16:Ma,setUint16:Ra,writeUint32:Fa,writeUint32BigEndian:qa,setUint32:ja,writeVarUint:mt,writeVarInt:Ue,_writeVarStringNative:Vi,_writeVarStringPolyfill:Oi,writeVarString:vn,writeBinaryEncoder:Pa,writeUint8Array:Rn,writeVarUint8Array:ss,writeOnDataView:Ke,writeFloat32:Ni,writeFloat64:Li,writeBigInt64:Mi,writeBigUint64:za,writeAny:Vn,RleEncoder:$r,IntDiffEncoder:Jr,RleIntDiffEncoder:Hr,UintOptRleEncoder:On,IncUintOptRleEncoder:Wr,IntDiffOptRleEncoder:Xr,StringEncoder:Zr}),Ga=Oa.create("Unexpected end of array"),$a=Oa.create("Integer out of Range"),wt=class{constructor(t){this.arr=t,this.pos=0}},is=e=>new wt(e),os=e=>e.pos!==e.arr.length,Ja=(e,t=e.pos)=>{let n=is(e.arr);return n.pos=t,n},cs=(e,t)=>{let n=Fn(e.arr.buffer,e.pos+e.arr.byteOffset,t);return e.pos+=t,n},ls=e=>cs(e,lt(e)),Ha=e=>cs(e,e.arr.length-e.pos),Ka=e=>e.pos++,Nn=e=>e.arr[e.pos++],Wa=e=>{let t=e.arr[e.pos]+(e.arr[e.pos+1]<<8);return e.pos+=2,t},Xa=e=>{let t=e.arr[e.pos]+(e.arr[e.pos+1]<<8)+(e.arr[e.pos+2]<<16)+(e.arr[e.pos+3]<<24)>>>0;return e.pos+=4,t},Za=e=>{let t=e.arr[e.pos+3]+(e.arr[e.pos+2]<<8)+(e.arr[e.pos+1]<<16)+(e.arr[e.pos]<<24)>>>0;return e.pos+=4,t},Ya=e=>e.arr[e.pos],Qa=e=>e.arr[e.pos]+(e.arr[e.pos+1]<<8),th=e=>e.arr[e.pos]+(e.arr[e.pos+1]<<8)+(e.arr[e.pos+2]<<16)+(e.arr[e.pos+3]<<24)>>>0,lt=e=>{let t=0,n=1,r=e.arr.length;for(;e.pos<r;){let s=e.arr[e.pos++];if(t=t+(s&C.BITS7)*n,n*=128,s<C.BIT8)return t;if(t>Ei.MAX_SAFE_INTEGER)throw $a}throw Ga},qt=e=>{let t=e.arr[e.pos++],n=t&C.BITS6,r=64,s=(t&C.BIT7)>0?-1:1;if(!(t&C.BIT8))return s*n;let i=e.arr.length;for(;e.pos<i;){if(t=e.arr[e.pos++],n=n+(t&C.BITS7)*r,r*=128,t<C.BIT8)return s*n;if(n>Ei.MAX_SAFE_INTEGER)throw $a}throw Ga},eh=e=>{let t=e.pos,n=lt(e);return e.pos=t,n},nh=e=>{let t=e.pos,n=qt(e);return e.pos=t,n},Ri=e=>{let t=lt(e);if(t===0)return"";{let n=String.fromCodePoint(Nn(e));if(--t<100)for(;t--;)n+=String.fromCodePoint(Nn(e));else for(;t>0;){let r=t<1e4?t:1e4,s=e.arr.subarray(e.pos,e.pos+r);e.pos+=r,n+=String.fromCodePoint.apply(null,s),t-=r}return decodeURIComponent(escape(n))}},Fi=e=>Be.utf8TextDecoder.decode(ls(e)),He=Be.utf8TextDecoder?Fi:Ri,rh=e=>{let t=e.pos,n=He(e);return e.pos=t,n},We=(e,t)=>{let n=new DataView(e.arr.buffer,e.arr.byteOffset+e.pos,t);return e.pos+=t,n},qi=e=>We(e,4).getFloat32(0,!1),ji=e=>We(e,8).getFloat64(0,!1),Pi=e=>We(e,8).getBigInt64(0,!1),sh=e=>We(e,8).getBigUint64(0,!1),Mf=[e=>{},e=>null,qt,qi,ji,Pi,e=>!1,e=>!0,He,e=>{let t=lt(e),n={};for(let r=0;r<t;r++){let s=He(e);n[s]=Ln(e)}return n},e=>{let t=lt(e),n=[];for(let r=0;r<t;r++)n.push(Ln(e));return n},ls],Ln=e=>Mf[127-Nn(e)](e),Yr=class extends wt{constructor(t,n){super(t),this.reader=n,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),os(this)?this.count=lt(this)+1:this.count=-1),this.count--,this.s}},Qr=class extends wt{constructor(t,n){super(t),this.s=n}read(){return this.s+=qt(this),this.s}},ts=class extends wt{constructor(t,n){super(t),this.s=n,this.count=0}read(){return this.count===0&&(this.s+=qt(this),os(this)?this.count=lt(this)+1:this.count=-1),this.count--,this.s}},Mn=class extends wt{constructor(t){super(t),this.s=0,this.count=0}read(){if(this.count===0){this.s=qt(this);let t=pt.isNegativeZero(this.s);this.count=1,t&&(this.s=-this.s,this.count=lt(this)+2)}return this.count--,this.s}},es=class extends wt{constructor(t){super(t),this.s=0,this.count=0}read(){if(this.count===0){this.s=qt(this);let t=pt.isNegativeZero(this.s);this.count=1,t&&(this.s=-this.s,this.count=lt(this)+2)}return this.count--,this.s++}},ns=class extends wt{constructor(t){super(t),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){let t=qt(this),n=t&1;this.diff=pt.floor(t/2),this.count=1,n&&(this.count=lt(this)+2)}return this.s+=this.diff,this.count--,this.s}},rs=class{constructor(t){this.decoder=new Mn(t),this.str=He(this.decoder),this.spos=0}read(){let t=this.spos+this.decoder.read(),n=this.str.slice(this.spos,t);return this.spos=t,n}},Rf=Object.freeze({__proto__:null,Decoder:wt,createDecoder:is,hasContent:os,clone:Ja,readUint8Array:cs,readVarUint8Array:ls,readTailAsUint8Array:Ha,skip8:Ka,readUint8:Nn,readUint16:Wa,readUint32:Xa,readUint32BigEndian:Za,peekUint8:Ya,peekUint16:Qa,peekUint32:th,readVarUint:lt,readVarInt:qt,peekVarUint:eh,peekVarInt:nh,_readVarStringPolyfill:Ri,_readVarStringNative:Fi,readVarString:He,peekVarString:rh,readFromDataView:We,readFloat32:qi,readFloat64:ji,readBigInt64:Pi,readBigUint64:sh,readAny:Ln,RleDecoder:Yr,IntDiffDecoder:Qr,RleIntDiffDecoder:ts,UintOptRleDecoder:Mn,IncUintOptRleDecoder:es,IntDiffOptRleDecoder:ns,StringDecoder:rs}),as=e=>new Uint8Array(e),Fn=(e,t,n)=>new Uint8Array(e,t,n),ih=e=>new Uint8Array(e),Ff=e=>{let t="";for(let n=0;n<e.byteLength;n++)t+=Be.fromCharCode(e[n]);return btoa(t)},qf=e=>Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("base64"),jf=e=>{let t=atob(e),n=as(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n},Pf=e=>{let t=Buffer.from(e,"base64");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)},oh=Va.isBrowser?Ff:qf,ch=Va.isBrowser?jf:Pf,lh=e=>{let t=as(e.byteLength);return t.set(e),t},ah=e=>{let t=Ci();return Vn(t,e),re(t)},hh=e=>Ln(is(e)),zf=Object.freeze({__proto__:null,createUint8ArrayFromLen:as,createUint8ArrayViewFromArrayBuffer:Fn,createUint8ArrayFromArrayBuffer:ih,toBase64:oh,fromBase64:ch,copyUint8Array:lh,encodeAny:ah,decodeAny:hh});p.Decoder=wt;p.Encoder=ct;p.IncUintOptRleDecoder=es;p.IncUintOptRleEncoder=Wr;p.IntDiffDecoder=Qr;p.IntDiffEncoder=Jr;p.IntDiffOptRleDecoder=ns;p.IntDiffOptRleEncoder=Xr;p.RleDecoder=Yr;p.RleEncoder=$r;p.RleIntDiffDecoder=ts;p.RleIntDiffEncoder=Hr;p.StringDecoder=rs;p.StringEncoder=Zr;p.UintOptRleDecoder=Mn;p.UintOptRleEncoder=On;p._readVarStringNative=Fi;p._readVarStringPolyfill=Ri;p._writeVarStringNative=Vi;p._writeVarStringPolyfill=Oi;p.buffer=zf;p.clone=Ja;p.copyUint8Array=lh;p.createDecoder=is;p.createEncoder=Ci;p.createUint8ArrayFromArrayBuffer=ih;p.createUint8ArrayFromLen=as;p.createUint8ArrayViewFromArrayBuffer=Fn;p.decodeAny=hh;p.decoding=Rf;p.encodeAny=ah;p.encoding=Lf;p.fromBase64=ch;p.hasContent=os;p.length=Di;p.peekUint16=Qa;p.peekUint32=th;p.peekUint8=Ya;p.peekVarInt=nh;p.peekVarString=rh;p.peekVarUint=eh;p.readAny=Ln;p.readBigInt64=Pi;p.readBigUint64=sh;p.readFloat32=qi;p.readFloat64=ji;p.readFromDataView=We;p.readTailAsUint8Array=Ha;p.readUint16=Wa;p.readUint32=Xa;p.readUint32BigEndian=Za;p.readUint8=Nn;p.readUint8Array=cs;p.readVarInt=qt;p.readVarString=He;p.readVarUint=lt;p.readVarUint8Array=ls;p.set=Je;p.setUint16=Ra;p.setUint32=ja;p.setUint8=La;p.skip8=Ka;p.toBase64=oh;p.toUint8Array=re;p.verifyLen=vi;p.write=D;p.writeAny=Vn;p.writeBigInt64=Mi;p.writeBigUint64=za;p.writeBinaryEncoder=Pa;p.writeFloat32=Ni;p.writeFloat64=Li;p.writeOnDataView=Ke;p.writeUint16=Ma;p.writeUint32=Fa;p.writeUint32BigEndian=qa;p.writeUint8=Na;p.writeUint8Array=Rn;p.writeVarInt=Ue;p.writeVarString=vn;p.writeVarUint=mt;p.writeVarUint8Array=ss});var hs=E(B=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0});var _=zi();Rt();Pr();Cn();_n();jr();ze();Lr();Rr();An();Ge();xn();Gr();B.Encoder=_.Encoder;B.IncUintOptRleEncoder=_.IncUintOptRleEncoder;B.IntDiffEncoder=_.IntDiffEncoder;B.IntDiffOptRleEncoder=_.IntDiffOptRleEncoder;B.RleEncoder=_.RleEncoder;B.RleIntDiffEncoder=_.RleIntDiffEncoder;B.StringEncoder=_.StringEncoder;B.UintOptRleEncoder=_.UintOptRleEncoder;B._writeVarStringNative=_._writeVarStringNative;B._writeVarStringPolyfill=_._writeVarStringPolyfill;B.createEncoder=_.createEncoder;B.length=_.length;B.set=_.set;B.setUint16=_.setUint16;B.setUint32=_.setUint32;B.setUint8=_.setUint8;B.toUint8Array=_.toUint8Array;B.verifyLen=_.verifyLen;B.write=_.write;B.writeAny=_.writeAny;B.writeBigInt64=_.writeBigInt64;B.writeBigUint64=_.writeBigUint64;B.writeBinaryEncoder=_.writeBinaryEncoder;B.writeFloat32=_.writeFloat32;B.writeFloat64=_.writeFloat64;B.writeOnDataView=_.writeOnDataView;B.writeUint16=_.writeUint16;B.writeUint32=_.writeUint32;B.writeUint32BigEndian=_.writeUint32BigEndian;B.writeUint8=_.writeUint8;B.writeUint8Array=_.writeUint8Array;B.writeVarInt=_.writeVarInt;B.writeVarString=_.writeVarString;B.writeVarUint=_.writeVarUint;B.writeVarUint8Array=_.writeVarUint8Array});var us=E(b=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0});var U=zi();Cn();Rt();Pr();_n();Gr();jr();ze();Lr();Rr();An();Ge();xn();b.Decoder=U.Decoder;b.IncUintOptRleDecoder=U.IncUintOptRleDecoder;b.IntDiffDecoder=U.IntDiffDecoder;b.IntDiffOptRleDecoder=U.IntDiffOptRleDecoder;b.RleDecoder=U.RleDecoder;b.RleIntDiffDecoder=U.RleIntDiffDecoder;b.StringDecoder=U.StringDecoder;b.UintOptRleDecoder=U.UintOptRleDecoder;b._readVarStringNative=U._readVarStringNative;b._readVarStringPolyfill=U._readVarStringPolyfill;b.clone=U.clone;b.createDecoder=U.createDecoder;b.hasContent=U.hasContent;b.peekUint16=U.peekUint16;b.peekUint32=U.peekUint32;b.peekUint8=U.peekUint8;b.peekVarInt=U.peekVarInt;b.peekVarString=U.peekVarString;b.peekVarUint=U.peekVarUint;b.readAny=U.readAny;b.readBigInt64=U.readBigInt64;b.readBigUint64=U.readBigUint64;b.readFloat32=U.readFloat32;b.readFloat64=U.readFloat64;b.readFromDataView=U.readFromDataView;b.readTailAsUint8Array=U.readTailAsUint8Array;b.readUint16=U.readUint16;b.readUint32=U.readUint32;b.readUint32BigEndian=U.readUint32BigEndian;b.readUint8=U.readUint8;b.readUint8Array=U.readUint8Array;b.readVarInt=U.readVarInt;b.readVarString=U.readVarString;b.readVarUint=U.readVarUint;b.readVarUint8Array=U.readVarUint8Array;b.skip8=U.skip8});var gh=E(at=>{"use strict";Object.defineProperty(at,"__esModule",{value:!0});var Gf=hs(),$f=us(),Jf=(Or(),Kn(Vr));function Gi(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(n){if(n!=="default"){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}}),t.default=e,Object.freeze(t)}var Xe=Gi(Gf),$i=Gi($f),Ji=Gi(Jf),Hi=0,Ki=1,Wi=2,Hf=(e,t)=>{Xe.writeVarUint(e,Hi);let n=Ji.encodeStateVector(t);Xe.writeVarUint8Array(e,n)},uh=(e,t,n)=>{Xe.writeVarUint(e,Ki),Xe.writeVarUint8Array(e,Ji.encodeStateAsUpdate(t,n))},dh=(e,t,n)=>uh(t,n,$i.readVarUint8Array(e)),Xi=(e,t,n)=>{try{Ji.applyUpdate(t,$i.readVarUint8Array(e),n)}catch(r){console.error("Caught error while handling a Yjs update",r)}},Kf=(e,t)=>{Xe.writeVarUint(e,Wi),Xe.writeVarUint8Array(e,t)},fh=Xi,Wf=(e,t,n,r)=>{let s=$i.readVarUint(e);switch(s){case Hi:dh(e,t,n);break;case Ki:Xi(e,n,r);break;case Wi:fh(e,n,r);break;default:throw new Error("Unknown message type")}return s};at.messageYjsSyncStep1=Hi;at.messageYjsSyncStep2=Ki;at.messageYjsUpdate=Wi;at.readSyncMessage=Wf;at.readSyncStep1=dh;at.readSyncStep2=Xi;at.readUpdate=fh;at.writeSyncStep1=Hf;at.writeSyncStep2=uh;at.writeUpdate=Kf});var Zi=E(V=>{"use strict";Object.defineProperty(V,"__esModule",{value:!0});var ds=Rt(),Xf=1e24,Zf=1e21,Yf=1e18,Qf=1e15,tg=1e12,eg=1e9,ng=1e6,rg=1e3,sg=100,ig=10,og=.1,cg=.01,lg=.001,ag=1e-6,hg=1e-9,ug=1e-12,dg=1e-15,fg=1e-18,gg=1e-21,pg=1e-24,mg=["","k","M","G","T","P","E","Z","Y"],wg=["","m","\u03BC","n","p","f","a","z","y"],yg=(e,t=0)=>{let n=e===0?0:ds.log10(e),r=0;for(;n<r*3&&t>-8;)t--,r--;for(;n>=3+r*3&&t<8;)t++,r++;let s=t<0?wg[-t]:mg[t];return{n:ds.round((r>0?e/ds.exp10(r*3):e*ds.exp10(r*-3))*1e12)/1e12,prefix:s}};V.atto=fg;V.centi=cg;V.deca=ig;V.deci=og;V.exa=Yf;V.femto=dg;V.giga=eg;V.hecto=sg;V.kilo=rg;V.mega=ng;V.micro=ag;V.milli=lg;V.nano=hg;V.peta=Qf;V.pico=ug;V.prefix=yg;V.tera=tg;V.yocto=pg;V.yotta=Xf;V.zepto=gg;V.zetta=Zf});var yh=E(jn=>{"use strict";var Ig=Zi(),qn=Rt(),ph=()=>new Date,mh=Date.now,wh=e=>{if(e<6e4){let i=Ig.prefix(e,-1);return qn.round(i.n*100)/100+i.prefix+"s"}e=qn.floor(e/1e3);let t=e%60,n=qn.floor(e/60)%60,r=qn.floor(e/3600)%24,s=qn.floor(e/86400);return s>0?s+"d"+(r>0||n>30?" "+(n>30?r+1:r)+"h":""):r>0?r+"h"+(n>0||t>30?" "+(t>30?n+1:n)+"min":""):n+"min"+(t>0?" "+t+"s":"")},Sg=Object.freeze({__proto__:null,getDate:ph,getUnixTime:mh,humanizeDuration:wh});jn.getDate=ph;jn.getUnixTime=mh;jn.humanizeDuration=wh;jn.time=Sg});var Ih=E(Pn=>{"use strict";Object.defineProperty(Pn,"__esModule",{value:!0});Zi();Rt();var Yi=yh();Pn.getDate=Yi.getDate;Pn.getUnixTime=Yi.getUnixTime;Pn.humanizeDuration=Yi.humanizeDuration});var Sh=E(F=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0});var P=Rt();F.abs=P.abs;F.add=P.add;F.ceil=P.ceil;F.exp10=P.exp10;F.floor=P.floor;F.imul=P.imul;F.isNaN=P.isNaN;F.isNegativeZero=P.isNegativeZero;F.log=P.log;F.log10=P.log10;F.log2=P.log2;F.max=P.max;F.min=P.min;F.pow=P.pow;F.round=P.round;F.sign=P.sign;F.sqrt=P.sqrt});var _h=E(Ze=>{"use strict";var Th=()=>new Set,bh=e=>Array.from(e),Bh=e=>e.values().next().value||void 0,Uh=e=>new Set(e),Tg=Object.freeze({__proto__:null,create:Th,toArray:bh,first:Bh,from:Uh});Ze.create=Th;Ze.first=Bh;Ze.from=Uh;Ze.set=Tg;Ze.toArray=bh});var xh=E(to=>{"use strict";Object.defineProperty(to,"__esModule",{value:!0});var fs=ze(),bg=_h(),Bg=Ge(),Qi=class{constructor(){this._observers=fs.create()}on(t,n){fs.setIfUndefined(this._observers,t,bg.create).add(n)}once(t,n){let r=(...s)=>{this.off(t,r),n(...s)};this.on(t,r)}off(t,n){let r=this._observers.get(t);r!==void 0&&(r.delete(n),r.size===0&&this._observers.delete(t))}emit(t,n){return Bg.from((this._observers.get(t)||fs.create()).values()).forEach(r=>r(...n))}destroy(){this._observers=fs.create()}};to.Observable=Qi});var kh=E(Et=>{"use strict";Object.defineProperty(Et,"__esModule",{value:!0});Ge();xn();var se=An();Et.apply=se.apply;Et.callAll=se.callAll;Et.equalityDeep=se.equalityDeep;Et.equalityFlat=se.equalityFlat;Et.equalityStrict=se.equalityStrict;Et.id=se.id;Et.isOneOf=se.isOneOf;Et.nop=se.nop});var Ch=E(ie=>{"use strict";Object.defineProperty(ie,"__esModule",{value:!0});var Ug=hs(),_g=us(),xg=Ih(),kg=Sh(),Ag=xh(),Eg=kh();Or();function zn(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(n){if(n!=="default"){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}}),t.default=e,Object.freeze(t)}var ht=zn(Ug),Ct=zn(_g),ps=zn(xg),Cg=zn(kg),Ah=zn(Eg),gs=3e4,eo=class extends Ag.Observable{constructor(t){super(),this.doc=t,this.clientID=t.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval(()=>{let n=ps.getUnixTime();this.getLocalState()!==null&&gs/2<=n-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());let r=[];this.meta.forEach((s,i)=>{i!==this.clientID&&gs<=n-s.lastUpdated&&this.states.has(i)&&r.push(i)}),r.length>0&&Eh(this,r,"timeout")},Cg.floor(gs/10)),t.on("destroy",()=>{this.destroy()}),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(t){let n=this.clientID,r=this.meta.get(n),s=r===void 0?0:r.clock+1,i=this.states.get(n);t===null?this.states.delete(n):this.states.set(n,t),this.meta.set(n,{clock:s,lastUpdated:ps.getUnixTime()});let o=[],c=[],l=[],h=[];t===null?h.push(n):i==null?t!=null&&o.push(n):(c.push(n),Ah.equalityDeep(i,t)||l.push(n)),(o.length>0||l.length>0||h.length>0)&&this.emit("change",[{added:o,updated:l,removed:h},"local"]),this.emit("update",[{added:o,updated:c,removed:h},"local"])}setLocalStateField(t,n){let r=this.getLocalState();r!==null&&this.setLocalState({...r,[t]:n})}getStates(){return this.states}},Eh=(e,t,n)=>{let r=[];for(let s=0;s<t.length;s++){let i=t[s];if(e.states.has(i)){if(e.states.delete(i),i===e.clientID){let o=e.meta.get(i);e.meta.set(i,{clock:o.clock+1,lastUpdated:ps.getUnixTime()})}r.push(i)}}r.length>0&&(e.emit("change",[{added:[],updated:[],removed:r},n]),e.emit("update",[{added:[],updated:[],removed:r},n]))},Dg=(e,t,n=e.states)=>{let r=t.length,s=ht.createEncoder();ht.writeVarUint(s,r);for(let i=0;i<r;i++){let o=t[i],c=n.get(o)||null,l=e.meta.get(o).clock;ht.writeVarUint(s,o),ht.writeVarUint(s,l),ht.writeVarString(s,JSON.stringify(c))}return ht.toUint8Array(s)},vg=(e,t)=>{let n=Ct.createDecoder(e),r=ht.createEncoder(),s=Ct.readVarUint(n);ht.writeVarUint(r,s);for(let i=0;i<s;i++){let o=Ct.readVarUint(n),c=Ct.readVarUint(n),l=JSON.parse(Ct.readVarString(n)),h=t(l);ht.writeVarUint(r,o),ht.writeVarUint(r,c),ht.writeVarString(r,JSON.stringify(h))}return ht.toUint8Array(r)},Vg=(e,t,n)=>{let r=Ct.createDecoder(t),s=ps.getUnixTime(),i=[],o=[],c=[],l=[],h=Ct.readVarUint(r);for(let a=0;a<h;a++){let u=Ct.readVarUint(r),f=Ct.readVarUint(r),d=JSON.parse(Ct.readVarString(r)),g=e.meta.get(u),I=e.states.get(u),S=g===void 0?0:g.clock;(S<f||S===f&&d===null&&e.states.has(u))&&(d===null?u===e.clientID&&e.getLocalState()!=null?f++:e.states.delete(u):e.states.set(u,d),e.meta.set(u,{clock:f,lastUpdated:s}),g===void 0&&d!==null?i.push(u):g!==void 0&&d===null?l.push(u):d!==null&&(Ah.equalityDeep(d,I)||c.push(u),o.push(u)))}(i.length>0||c.length>0||l.length>0)&&e.emit("change",[{added:i,updated:c,removed:l},n]),(i.length>0||o.length>0||l.length>0)&&e.emit("update",[{added:i,updated:o,removed:l},n])};ie.Awareness=eo;ie.applyAwarenessUpdate=Vg;ie.encodeAwarenessUpdate=Dg;ie.modifyAwarenessUpdate=vg;ie.outdatedTimeout=gs;ie.removeAwarenessStates=Eh});var Dh=E(oe=>{"use strict";Object.defineProperty(oe,"__esModule",{value:!0});var Ye=ze();oe.all=Ye.all;oe.any=Ye.any;oe.copy=Ye.copy;oe.create=Ye.create;oe.map=Ye.map;oe.setIfUndefined=Ye.setIfUndefined});var Nh=E((mm,Oh)=>{var Og="Expected a function",vh=NaN,Ng="[object Symbol]",Lg=/^\s+|\s+$/g,Mg=/^[-+]0x[0-9a-f]+$/i,Rg=/^0b[01]+$/i,Fg=/^0o[0-7]+$/i,qg=parseInt,jg=typeof global=="object"&&global&&global.Object===Object&&global,Pg=typeof self=="object"&&self&&self.Object===Object&&self,zg=jg||Pg||Function("return this")(),Gg=Object.prototype,$g=Gg.toString,Jg=Math.max,Hg=Math.min,no=function(){return zg.Date.now()};function Kg(e,t,n){var r,s,i,o,c,l,h=0,a=!1,u=!1,f=!0;if(typeof e!="function")throw new TypeError(Og);t=Vh(t)||0,ro(n)&&(a=!!n.leading,u="maxWait"in n,i=u?Jg(Vh(n.maxWait)||0,t):i,f="trailing"in n?!!n.trailing:f);function d(M){var jt=r,en=s;return r=s=void 0,h=M,o=e.apply(en,jt),o}function g(M){return h=M,c=setTimeout(Dt,t),a?d(M):o}function I(M){var jt=M-l,en=M-h,ho=t-jt;return u?Hg(ho,i-en):ho}function S(M){var jt=M-l,en=M-h;return l===void 0||jt>=t||jt<0||u&&en>=i}function Dt(){var M=no();if(S(M))return tn(M);c=setTimeout(Dt,I(M))}function tn(M){return c=void 0,f&&r?d(M):(r=s=void 0,o)}function Hn(){c!==void 0&&clearTimeout(c),h=0,r=l=s=c=void 0}function qh(){return c===void 0?o:tn(no())}function ys(){var M=no(),jt=S(M);if(r=arguments,s=this,l=M,jt){if(c===void 0)return g(l);if(u)return c=setTimeout(Dt,t),d(l)}return c===void 0&&(c=setTimeout(Dt,t)),o}return ys.cancel=Hn,ys.flush=qh,ys}function ro(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function Wg(e){return!!e&&typeof e=="object"}function Xg(e){return typeof e=="symbol"||Wg(e)&&$g.call(e)==Ng}function Vh(e){if(typeof e=="number")return e;if(Xg(e))return vh;if(ro(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=ro(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(Lg,"");var n=Rg.test(e);return n||Fg.test(e)?qg(e.slice(2),n?2:8):Mg.test(e)?vh:+e}Oh.exports=Kg});var Lh={};uo(Lh,{request:()=>Zg});function Zg(){console.error("request() is not implemented yet")}var Mh=k(()=>{"use strict"});var io=E(so=>{var Rh={};so.isCallbackSet=!1;so.callbackHandler=(e,t,n)=>{let s={room:n.name,data:{}};Object.keys(Rh).forEach(o=>{let c=Rh[o];s.data[o]={type:c,content:Qg(o,c,n).toJSON()}}),Yg(null,5e3,s)};var Yg=(e,t,n)=>{n=JSON.stringify(n);let r={hostname:e.hostname,port:e.port,path:e.pathname,timeout:t,method:"POST",headers:{"Content-Type":"application/json","Content-Length":n.length}},s=(Mh(),Kn(Lh)).request(r);s.on("timeout",()=>{console.warn("Callback request timed out."),s.abort()}),s.on("error",i=>{console.error("Callback request error.",i),s.abort()}),s.write(n),s.end()},Qg=(e,t,n)=>{switch(t){case"Array":return n.getArray(e);case"Map":return n.getMap(e);case"Text":return n.getText(e);case"XmlFragment":return n.getXmlFragment(e);case"XmlElement":return n.getXmlElement(e);default:return{}}}});var tp=(Or(),Kn(Vr)),lo=gh(),$n=Ch(),j=hs(),oo=us(),ep=Dh(),np=Nh(),rp=io().callbackHandler,sp=io().isCallbackSet,ip=parseInt(2e3)||2e3,op=parseInt(1e4)||1e4,cp=0,lp=1;var ap=void 0!=="false"&&void 0!=="0";var Qe=null;exports.setPersistence=e=>{Qe=e};exports.getPersistence=()=>Qe;var ms=new Map;exports.docs=ms;var ws=0,ao=1,hp=(e,t,n)=>{let r=j.createEncoder();j.writeVarUint(r,ws),lo.writeUpdate(r,e);let s=j.toUint8Array(r);n.conns.forEach((i,o)=>Jn(n,o,s))},co=class extends tp.Doc{constructor(t){super({gc:ap}),this.name=t,this.conns=new Map,this.awareness=new $n.Awareness(this),this.awareness.setLocalState(null);let n=({added:r,updated:s,removed:i},o)=>{let c=r.concat(s,i);if(o!==null){let a=this.conns.get(o);a!==void 0&&(r.forEach(u=>{a.add(u)}),i.forEach(u=>{a.delete(u)}))}let l=j.createEncoder();j.writeVarUint(l,ao),j.writeVarUint8Array(l,$n.encodeAwarenessUpdate(this.awareness,c));let h=j.toUint8Array(l);this.conns.forEach((a,u)=>{Jn(this,u,h)})};this.awareness.on("update",n),this.on("update",hp),sp&&this.on("update",np(rp,ip,{maxWait:op}))}},Fh=(e,t=!0)=>ep.setIfUndefined(ms,e,()=>{let n=new co(e);return n.gc=t,Qe!==null&&Qe.bindState(e,n),ms.set(e,n),n});exports.getYDoc=Fh;var up=(e,t,n)=>{try{let r=j.createEncoder(),s=oo.createDecoder(n);switch(oo.readVarUint(s)){case ws:j.writeVarUint(r,ws),lo.readSyncMessage(s,r,t,null),j.length(r)>1&&Jn(t,e,j.toUint8Array(r));break;case ao:{$n.applyAwarenessUpdate(t.awareness,oo.readVarUint8Array(s),e);break}}}catch(r){t.emit("error",[r])}},Gn=(e,t)=>{if(e.conns.has(t)){let n=e.conns.get(t);e.conns.delete(t),$n.removeAwarenessStates(e.awareness,Array.from(n),null),e.conns.size===0&&Qe!==null&&(Qe.writeState(e.name,e).then(()=>{e.destroy()}),ms.delete(e.name))}t.close()},Jn=(e,t,n)=>{t.readyState!==void 0&&t.readyState!==cp&&t.readyState!==lp&&Gn(e,t);try{t.send(n)}catch{Gn(e,t)}},dp=3e4;exports.setupWSConnection=(e,t,{docName:n=t.url.slice(1).split("?")[0],gc:r=!0}={})=>{let s=Fh(n,r);s.conns.set(e,new Set),e.on("message",c=>up(e,s,new Uint8Array(c)));let i=!0,o=setInterval(()=>{if(!i)s.conns.has(e)&&Gn(s,e),clearInterval(o);else if(s.conns.has(e)){i=!1;try{e.ping()}catch{Gn(s,e),clearInterval(o)}}},dp);e.on("close",()=>{Gn(s,e),clearInterval(o)}),e.on("pong",()=>{i=!0});{let c=j.createEncoder();j.writeVarUint(c,ws),lo.writeSyncStep1(c,s),Jn(s,e,j.toUint8Array(c));let l=s.awareness.getStates();if(l.size>0){let h=j.createEncoder();j.writeVarUint(h,ao),j.writeVarUint8Array(h,$n.encodeAwarenessUpdate(s.awareness,Array.from(l.keys()))),Jn(s,e,j.toUint8Array(h))}}};
//# sourceMappingURL=y-websocket-utils.js.map
